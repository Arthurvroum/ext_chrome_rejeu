(function(){"use strict";var e={5123:function(e,t,r){var a=r(9746),s=r(5976);function o(e,t,r,a,o,l){const i=(0,s.g2)("ReplayTab"),n=(0,s.g2)("v-app-bar-title"),u=(0,s.g2)("v-app-bar"),c=(0,s.g2)("RecordTab"),d=(0,s.g2)("v-container"),p=(0,s.g2)("v-main"),g=(0,s.g2)("v-app");return(0,s.uX)(),(0,s.Wv)(g,null,{default:(0,s.k6)((()=>[o.isReplayTab?((0,s.uX)(),(0,s.Wv)(i,{key:0,class:"fullscreen-component full-width-app"})):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.bF)(u,{color:"primary",density:"compact",elevation:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{class:"text-white"},{default:(0,s.k6)((()=>t[0]||(t[0]=[(0,s.eW)("Network Request Recorder")]))),_:1})])),_:1}),(0,s.bF)(p,null,{default:(0,s.k6)((()=>[(0,s.bF)(d,{fluid:""},{default:(0,s.k6)((()=>[(0,s.bF)(c,{onOpenReplay:l.openReplayTab},null,8,["onOpenReplay"])])),_:1})])),_:1})],64))])),_:1})}r(4603),r(7566),r(8721);var l=r(160);const i={class:"record-tab"},n={key:0};function u(e,t,r,a,o,u){const c=(0,s.g2)("record-controls"),d=(0,s.g2)("v-alert-title"),p=(0,s.g2)("v-alert"),g=(0,s.g2)("v-icon"),b=(0,s.g2)("v-card-title"),m=(0,s.g2)("v-chip"),v=(0,s.g2)("v-btn"),h=(0,s.g2)("v-divider"),f=(0,s.g2)("v-tab"),y=(0,s.g2)("v-tabs"),k=(0,s.g2)("v-window-item"),x=(0,s.g2)("variable-capture-form"),S=(0,s.g2)("v-window"),R=(0,s.g2)("v-card-text"),w=(0,s.g2)("v-card"),F=(0,s.g2)("v-expand-transition"),C=(0,s.g2)("v-list-item"),_=(0,s.g2)("v-list");return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.bF)(c,{"is-recording":o.isRecording,"recorded-count":o.recordedCount,status:o.recordingStatus,"has-recorded-data":u.hasRecordedData,disabled:o.restrictedUrlWarning,onToggleRecording:u.toggleRecording,onExportRecording:u.exportRecording,onClearRecordings:u.clearRecordings,onOpenReplayTab:u.openReplayInNewTab},null,8,["is-recording","recorded-count","status","has-recorded-data","disabled","onToggleRecording","onExportRecording","onClearRecordings","onOpenReplayTab"]),o.restrictedUrlWarning?((0,s.uX)(),(0,s.Wv)(p,{key:0,type:"warning",variant:"tonal",icon:"mdi-alert",border:"start",class:"mb-4"},{default:(0,s.k6)((()=>[(0,s.bF)(d,null,{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)("Cannot record from this page")]))),_:1}),t[3]||(t[3]=(0,s.eW)(" Recording is not possible on browser internal pages or extension pages. Please navigate to a regular website to use recording features. "))])),_:1})):(0,s.Q3)("",!0),u.hasRecordedData?((0,s.uX)(),(0,s.Wv)(w,{key:1,variant:"outlined"},{default:(0,s.k6)((()=>[(0,s.bF)(b,{class:"bg-grey-lighten-4"},{default:(0,s.k6)((()=>[(0,s.bF)(g,{icon:"mdi-format-list-bulleted",class:"mr-2"}),(0,s.eW)(" Recorded Requests ("+(0,l.v_)(o.recordedRequests.length)+") ",1)])),_:1}),(0,s.bF)(_,null,{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.recordedRequests,((r,a)=>((0,s.uX)(),(0,s.Wv)(C,{key:a,subtitle:r.url,value:a},{prepend:(0,s.k6)((()=>[(0,s.bF)(m,{color:u.getMethodColor(r.method),size:"small",label:"",class:"mr-2"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(r.method),1)])),_:2},1032,["color"])])),append:(0,s.k6)((()=>[r.statusCode?((0,s.uX)(),(0,s.Wv)(m,{key:0,color:u.getStatusColor(r.statusCode),size:"small",label:""},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(r.statusCode),1)])),_:2},1032,["color"])):(0,s.Q3)("",!0),(0,s.bF)(v,{variant:"text",size:"small",icon:"mdi-chevron-down",onClick:e=>u.toggleDetails(a),class:(0,l.C4)({"rotate-icon":o.expandedRequest===a})},null,8,["onClick","class"])])),default:(0,s.k6)((()=>[(0,s.bF)(F,null,{default:(0,s.k6)((()=>[o.expandedRequest===a?((0,s.uX)(),(0,s.CE)("div",n,[(0,s.bF)(h),(0,s.bF)(w,{flat:""},{default:(0,s.k6)((()=>[(0,s.bF)(y,{modelValue:o.activeTab,"onUpdate:modelValue":t[0]||(t[0]=e=>o.activeTab=e)},{default:(0,s.k6)((()=>[(0,s.bF)(f,{value:"headers"},{default:(0,s.k6)((()=>t[4]||(t[4]=[(0,s.eW)("Request Headers")]))),_:1}),r.requestBody?((0,s.uX)(),(0,s.Wv)(f,{key:0,value:"body"},{default:(0,s.k6)((()=>t[5]||(t[5]=[(0,s.eW)("Request Body")]))),_:1})):(0,s.Q3)("",!0),r.responseHeaders?((0,s.uX)(),(0,s.Wv)(f,{key:1,value:"response"},{default:(0,s.k6)((()=>t[6]||(t[6]=[(0,s.eW)("Response")]))),_:1})):(0,s.Q3)("",!0),(0,s.bF)(f,{value:"capture"},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.eW)("Variable Capture")]))),_:1})])),_:2},1032,["modelValue"]),(0,s.bF)(R,null,{default:(0,s.k6)((()=>[(0,s.bF)(S,{modelValue:o.activeTab,"onUpdate:modelValue":t[1]||(t[1]=e=>o.activeTab=e)},{default:(0,s.k6)((()=>[(0,s.bF)(k,{value:"headers"},{default:(0,s.k6)((()=>[(0,s.Lk)("pre",null,(0,l.v_)(e.formatHeaders(r.requestHeaders)),1)])),_:2},1024),r.requestBody?((0,s.uX)(),(0,s.Wv)(k,{key:0,value:"body"},{default:(0,s.k6)((()=>[(0,s.Lk)("pre",null,(0,l.v_)(e.formatBody(r.requestBody)),1)])),_:2},1024)):(0,s.Q3)("",!0),r.responseHeaders?((0,s.uX)(),(0,s.Wv)(k,{key:1,value:"response"},{default:(0,s.k6)((()=>[(0,s.Lk)("pre",null,(0,l.v_)(e.formatHeaders(r.responseHeaders)),1)])),_:2},1024)):(0,s.Q3)("",!0),(0,s.bF)(k,{value:"capture"},{default:(0,s.k6)((()=>[(0,s.bF)(x,{request:r,onAddCapture:u.addVariableCapture,onUpdateRequest:e=>u.updateRequest(a,e)},null,8,["request","onAddCapture","onUpdateRequest"])])),_:2},1024)])),_:2},1032,["modelValue"])])),_:2},1024)])),_:2},1024)])):(0,s.Q3)("",!0)])),_:2},1024)])),_:2},1032,["subtitle","value"])))),128))])),_:1})])),_:1})):((0,s.uX)(),(0,s.Wv)(w,{key:2,class:"d-flex align-center justify-center py-12 px-6 text-center",height:"200"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",null,[(0,s.bF)(g,{icon:"mdi-information-outline",size:"large",color:"grey-lighten-1",class:"mb-4"}),t[8]||(t[8]=(0,s.Lk)("div",{class:"text-h6 mb-2"},"No requests recorded yet",-1)),t[9]||(t[9]=(0,s.Lk)("div",{class:"text-body-2 text-grey"},'Click "Start Recording" to begin capturing HTTP requests.',-1))])])),_:1}))])}r(4114);const c={key:0},d={key:1},p={class:"d-flex flex-column"},g={class:"d-flex justify-space-between align-center button-container mb-2"},b={class:"d-flex justify-space-between align-center button-container mb-2"},m={class:"d-flex justify-space-between align-center button-container"},v={class:"text-caption text-center mt-2"};function h(e,t,r,a,o,i){const n=(0,s.g2)("v-alert"),u=(0,s.g2)("v-icon"),h=(0,s.g2)("v-btn"),f=(0,s.g2)("v-card-text"),y=(0,s.g2)("v-card");return(0,s.uX)(),(0,s.Wv)(y,{variant:"outlined",class:"mb-4"},{default:(0,s.k6)((()=>[(0,s.bF)(f,null,{default:(0,s.k6)((()=>[(0,s.bF)(n,{color:r.isRecording?"error":"info",icon:r.isRecording?"mdi-record-circle":"mdi-information",border:"start",variant:"tonal",class:"mb-2",density:"compact"},{default:(0,s.k6)((()=>[r.isRecording?((0,s.uX)(),(0,s.CE)("span",c,"Recording in progress... ("+(0,l.v_)(r.recordedCount)+" requests)",1)):((0,s.uX)(),(0,s.CE)("span",d,"Ready to record"))])),_:1},8,["color","icon"]),(0,s.Lk)("div",p,[(0,s.Lk)("div",g,[(0,s.bF)(h,{color:r.isRecording?"error":"primary",onClick:i.toggleRecording,disabled:r.disabled,density:"comfortable",size:"small",variant:"elevated",class:"flex-grow-1 action-button"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{icon:r.isRecording?"mdi-stop":"mdi-record",size:"small",class:"mr-1"},null,8,["icon"]),(0,s.eW)(" "+(0,l.v_)(r.isRecording?"Stop":"Start Recording"),1)])),_:1},8,["color","onClick","disabled"])]),(0,s.Lk)("div",b,[(0,s.bF)(h,{color:"info",onClick:i.openReplayTab,density:"comfortable",size:"small",variant:"elevated",class:"flex-grow-1 action-button"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{icon:"mdi-tab",size:"small",class:"mr-1"}),t[0]||(t[0]=(0,s.eW)(" Open Replay Tab "))])),_:1},8,["onClick"])]),(0,s.Lk)("div",m,[(0,s.bF)(h,{color:"secondary",onClick:i.exportRecording,disabled:!r.hasRecordedData,density:"comfortable",size:"small",variant:"elevated",class:"flex-grow-1 action-button mr-2"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{icon:"mdi-export",size:"small",class:"mr-1"}),t[1]||(t[1]=(0,s.eW)(" Export "))])),_:1},8,["onClick","disabled"]),(0,s.bF)(h,{color:"warning",onClick:i.clearRecordings,disabled:!r.hasRecordedData,density:"comfortable",size:"small",variant:"elevated",class:"flex-grow-1 action-button"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{icon:"mdi-delete",size:"small",class:"mr-1"}),t[2]||(t[2]=(0,s.eW)(" Clear Data "))])),_:1},8,["onClick","disabled"])])]),(0,s.Lk)("div",v,(0,l.v_)(r.status),1)])),_:1})])),_:1})}var f={name:"RecordControls",props:{isRecording:{type:Boolean,default:!1},recordedCount:{type:Number,default:0},status:{type:String,default:"Ready to record"},hasRecordedData:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},methods:{toggleRecording(){this.$emit("toggle-recording")},exportRecording(){this.$emit("export-recording")},clearRecordings(){this.$emit("clear-recordings")},openReplayTab(){this.$emit("open-replay-tab")}}},y=r(1169);const k=(0,y.A)(f,[["render",h],["__scopeId","data-v-5b746739"]]);var x=k;const S={class:"variable-capture"},R={key:0,class:"existing-captures"},w={class:"capture-info"},F={class:"capture-source"},C=["onClick"],_=["onClick"];function V(e,t,r,o,i,n){const u=(0,s.g2)("v-btn"),c=(0,s.g2)("v-card-title"),d=(0,s.g2)("v-text-field"),p=(0,s.g2)("v-col"),g=(0,s.g2)("v-row"),b=(0,s.g2)("v-select"),m=(0,s.g2)("v-checkbox"),v=(0,s.g2)("v-form"),h=(0,s.g2)("v-card-text"),f=(0,s.g2)("v-spacer"),y=(0,s.g2)("v-card-actions"),k=(0,s.g2)("v-card"),x=(0,s.g2)("v-dialog");return(0,s.uX)(),(0,s.CE)("div",S,[n.hasCaptureConfig?((0,s.uX)(),(0,s.CE)("div",R,[t[10]||(t[10]=(0,s.Lk)("h5",null,"Captures de variables configurées",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.request.variableCapture,((e,r)=>((0,s.uX)(),(0,s.CE)("div",{key:r,class:"capture-item"},[(0,s.Lk)("div",w,[(0,s.Lk)("strong",null,(0,l.v_)(e.name),1),(0,s.eW)(" - "+(0,l.v_)(e.regex)+" ",1),(0,s.Lk)("div",F,(0,l.v_)(e.source),1)]),(0,s.Lk)("button",{onClick:e=>n.editCapture(r),class:"edit-button",title:"Modifier"},t[8]||(t[8]=[(0,s.Lk)("i",{class:"fas fa-edit"},null,-1)]),8,C),(0,s.Lk)("button",{onClick:e=>n.removeCapture(r),class:"remove-button",title:"Supprimer"},t[9]||(t[9]=[(0,s.Lk)("i",{class:"fas fa-times"},null,-1)]),8,_)])))),128))])):(0,s.Q3)("",!0),(0,s.bF)(u,{color:"primary",onClick:n.showAddCaptureDialog,class:"mt-3"},{default:(0,s.k6)((()=>t[11]||(t[11]=[(0,s.Lk)("i",{class:"fas fa-plus mr-2"},null,-1),(0,s.eW)(" Ajouter une capture de variable ")]))),_:1},8,["onClick"]),(0,s.bF)(x,{modelValue:i.showEditDialog,"onUpdate:modelValue":t[7]||(t[7]=e=>i.showEditDialog=e),"max-width":"600px"},{default:(0,s.k6)((()=>[(0,s.bF)(k,null,{default:(0,s.k6)((()=>[(0,s.bF)(c,{class:"bg-primary text-white"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(null!==i.editIndex?"Modifier la capture":"Nouvelle capture de variable"),1)])),_:1}),(0,s.bF)(h,{class:"pt-4"},{default:(0,s.k6)((()=>[(0,s.bF)(v,{onSubmit:(0,a.D$)(n.saveCapture,["prevent"])},{default:(0,s.k6)((()=>[(0,s.bF)(g,null,{default:(0,s.k6)((()=>[(0,s.bF)(p,{cols:"12",sm:"6"},{default:(0,s.k6)((()=>[(0,s.bF)(d,{modelValue:i.captureName,"onUpdate:modelValue":t[0]||(t[0]=e=>i.captureName=e),label:"Nom de variable",variant:"outlined",rules:[e=>!!e||"Le nom est requis"]},null,8,["modelValue","rules"])])),_:1}),(0,s.bF)(p,{cols:"12",sm:"6"},{default:(0,s.k6)((()=>[(0,s.bF)(d,{modelValue:i.captureRegex,"onUpdate:modelValue":t[1]||(t[1]=e=>i.captureRegex=e),label:"Expression régulière",variant:"outlined",rules:[e=>!!e||"L'expression est requise"]},null,8,["modelValue","rules"])])),_:1})])),_:1}),(0,s.bF)(g,null,{default:(0,s.k6)((()=>[(0,s.bF)(p,{cols:"12",sm:"6"},{default:(0,s.k6)((()=>[(0,s.bF)(b,{modelValue:i.captureSource,"onUpdate:modelValue":t[2]||(t[2]=e=>i.captureSource=e),label:"Source",items:["responseBody","responseHeaders","url"],variant:"outlined"},null,8,["modelValue"])])),_:1}),(0,s.bF)(p,{cols:"12",sm:"6"},{default:(0,s.k6)((()=>[(0,s.bF)(m,{modelValue:i.captureRequired,"onUpdate:modelValue":t[3]||(t[3]=e=>i.captureRequired=e),label:"Obligatoire"},null,8,["modelValue"])])),_:1})])),_:1}),(0,s.bF)(g,null,{default:(0,s.k6)((()=>[(0,s.bF)(p,{cols:"12",sm:"6"},{default:(0,s.k6)((()=>[(0,s.bF)(m,{modelValue:i.captureFailOnError,"onUpdate:modelValue":t[4]||(t[4]=e=>i.captureFailOnError=e),label:"Échouer en cas d'erreur"},null,8,["modelValue"])])),_:1}),(0,s.bF)(p,{cols:"12",sm:"6"},{default:(0,s.k6)((()=>[(0,s.bF)(b,{modelValue:i.captureScope,"onUpdate:modelValue":t[5]||(t[5]=e=>i.captureScope=e),label:"Portée",items:[{title:"Globale",value:"global"},{title:"Cette étape uniquement",value:"step"}],variant:"outlined"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1}),(0,s.bF)(y,null,{default:(0,s.k6)((()=>[(0,s.bF)(f),(0,s.bF)(u,{color:"grey",text:"",onClick:t[6]||(t[6]=e=>i.showEditDialog=!1)},{default:(0,s.k6)((()=>t[12]||(t[12]=[(0,s.eW)("Annuler")]))),_:1}),(0,s.bF)(u,{color:"primary",onClick:n.saveCapture},{default:(0,s.k6)((()=>t[13]||(t[13]=[(0,s.eW)("Enregistrer")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}var E={name:"VariableCaptureForm",props:{request:{type:Object,required:!0}},data(){return{showEditDialog:!1,editIndex:null,captureName:"",captureRegex:"",captureSource:"responseBody",captureRequired:!0,captureFailOnError:!1,captureScope:"global"}},computed:{isValid(){return this.captureName&&this.captureRegex},hasCaptureConfig(){return this.request.variableCapture&&this.request.variableCapture.length>0}},methods:{showAddCaptureDialog(){this.editIndex=null,this.captureName="",this.captureRegex="",this.captureSource="responseBody",this.captureRequired=!0,this.captureFailOnError=!1,this.captureScope="global",this.showEditDialog=!0},saveCapture(){if(!this.captureName||!this.captureRegex)return;const e={name:this.captureName,regex:this.captureRegex,source:this.captureSource,required:this.captureRequired,failOnError:this.captureFailOnError,scope:this.captureScope};null!==this.editIndex?this.$set(this.request.variableCapture,this.editIndex,e):(this.request.variableCapture||this.$set(this.request,"variableCapture",[]),this.request.variableCapture.push(e)),this.resetForm(),this.showEditDialog=!1},editCapture(e){const t=this.request.variableCapture[e];this.captureName=t.name,this.captureRegex=t.regex,this.captureSource=t.source||"responseBody",this.captureRequired=!1!==t.required,this.captureFailOnError=!0===t.failOnError,this.captureScope=t.scope||"global",this.editIndex=e,this.showEditDialog=!0},removeCapture(e){this.request.variableCapture.splice(e,1),0===this.request.variableCapture.length&&this.$delete(this.request,"variableCapture")},resetForm(){this.editIndex=null,this.captureName="",this.captureRegex="",this.captureSource="responseBody",this.captureRequired=!0,this.captureFailOnError=!1,this.captureScope="global"}}};const q=(0,y.A)(E,[["render",V],["__scopeId","data-v-5803fc95"]]);var L=q;function O(e){return new Promise(((t,r)=>{try{chrome.runtime.sendMessage(e,(e=>{chrome.runtime.lastError?(console.error("Error sending message:",chrome.runtime.lastError),r(chrome.runtime.lastError)):t(e)}))}catch(a){console.error("Error sending message:",a),r(a)}}))}function D(e,t){return new Promise(((r,a)=>{try{chrome.tabs.sendMessage(e,t,(e=>{chrome.runtime.lastError?(console.warn("Tab message error:",chrome.runtime.lastError.message),a(chrome.runtime.lastError)):r(e)}))}catch(s){console.error("Error sending message to tab:",s),a(s)}}))}function W(){return new Promise(((e,t)=>{try{chrome.tabs.query({active:!0,currentWindow:!0},(r=>{chrome.runtime.lastError?t(chrome.runtime.lastError):r&&r.length>0?e(r[0]):t(new Error("No active tab found"))}))}catch(r){t(r)}}))}function U(e){if(!e)return!0;const t=["chrome://","chrome-extension://","devtools://","chrome-devtools://","edge://","brave://","view-source:","about:","file://","data:","javascript:"];return t.some((t=>e.startsWith(t)))}function I(e){return new Promise((async(t,r)=>{try{const a=await chrome.tabs.get(e);if(U(a.url))return void r(new Error(`Cannot inject content script into restricted URL: ${a.url}`));if(a.url.startsWith("http")){const r=await chrome.scripting.executeScript({target:{tabId:e},files:["content-script.js"]});t(r)}else r(new Error(`Cannot inject content script into URL: ${a.url}`))}catch(a){r(a)}}))}function T(e,t=1e3){return new Promise((r=>{const a=Date.now();function s(){try{D(e,{action:"pingContentScript"}).then((e=>{console.log("Content script is ready:",e),r(!0)})).catch((()=>{Date.now()-a<t?setTimeout(s,100):r(!1)}))}catch(o){Date.now()-a<t?setTimeout(s,100):r(!1)}}s()}))}r(7126);let A=0;const $=2e3,N={async getRecordingStatus(){try{const e=await O({action:"getRecordingStatus"});return e}catch(e){return console.error("Error getting recording status:",e),{isRecording:!1,error:e.message}}},async startRecording(){try{const t=await W();if(U(t.url))return{status:"error",error:"Cannot record from restricted URLs like browser pages or extension pages",restrictedUrl:!0};const r=await T(t.id);if(!r)try{await I(t.id),await new Promise((e=>setTimeout(e,200)))}catch(e){console.warn("Error injecting content script:",e)}const a=await O({action:"startRecording",tabId:t.id});try{await D(t.id,{action:"startObserving"})}catch(e){console.warn("Error notifying content script:",e)}return a}catch(e){return console.error("Error starting recording:",e),{status:"error",error:e.message}}},async stopRecording(){try{const t=await O({action:"stopRecording"}),r=await W();try{await D(r.id,{action:"stopObserving"})}catch(e){console.warn("Error notifying content script:",e)}return t?t.error?(console.error("Error in stop recording response:",t.error),{status:"error",error:t.error,data:t.data||[]}):t.data||"Recording stopped"!==t.status?t:(console.warn("No data in successful stop recording response"),{status:"success",message:"Recording stopped successfully",data:[]}):(console.warn("Empty response from background script when stopping recording"),{status:"warning",message:"Recording stopped, but no data was returned",data:[]})}catch(e){return console.error("Error stopping recording:",e),{status:"error",error:e.message||"Unknown error stopping recording",data:[]}}},async exportAsOpenAPI(e){try{const t=await O({action:"convertToOpenAPI",data:e});if(t&&t.openApiSpec){P(t.openApiSpec);const e=new Blob([JSON.stringify(t.openApiSpec,null,2)],{type:"application/json"}),r=URL.createObjectURL(e),a=document.createElement("a");return a.href=r,a.download="recorded-requests.json",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r),{success:!0}}throw new Error("Failed to convert to OpenAPI format")}catch(t){return console.error("Error exporting as OpenAPI:",t),{success:!1,error:t.message}}},async openReplayInNewTab(e=[]){const t=Date.now();if(t-A<$)return console.log("Ignoring duplicate openReplayInNewTab call","Last call:",A,"Current time:",t,"Difference:",t-A),{success:!1,error:"Too many requests. Try again in a moment."};A=t;try{const t=e?JSON.parse(JSON.stringify(e)):[],r=Date.now();await chrome.storage.local.set({latestRecordedData:t,replayWindowData:t,replayWindowDataCount:t.length,autoLoadLatestRecording:!0,recordingTimestamp:r,lastReplayTabRequest:r});const a=await O({action:"openReplayWindow",data:t,count:t.length,timestamp:r});return a}catch(r){return console.error("Error opening replay tab:",r),{success:!1,error:r.message}}}};function P(e){return e.openapi&&e.openapi.startsWith("3.0")||console.warn("Warning: OpenAPI version should be 3.0.x"),e.info||console.warn("Warning: Missing info object in OpenAPI spec"),e.paths&&0!==Object.keys(e.paths).length||console.warn("Warning: No paths defined in OpenAPI spec"),e["x-original-urls"]&&0!==Object.keys(e["x-original-urls"]).length||console.warn("Warning: Missing x-original-urls map for proper replay"),!0}var X=N,j={name:"RecordTab",components:{RecordControls:x,VariableCaptureForm:L},data(){return{isRecording:!1,recordingStatus:"Ready to record",recordedRequests:[],recordedCount:0,expandedRequest:null,activeTab:null,restrictedUrlWarning:!1,activeTabId:null,activeTabUrl:"",contentScriptReady:!1,isOpeningReplayTab:!1}},computed:{hasRecordedData(){return this.recordedRequests&&this.recordedRequests.length>0}},mounted(){this.checkRecordingStatus(),this.statusInterval=setInterval((()=>{this.isRecording&&this.updateRecordingStatus()}),2e3),this.checkCurrentPageCompatibility()},beforeUnmount(){this.statusInterval&&clearInterval(this.statusInterval)},methods:{async checkRecordingStatus(){const e=await X.getRecordingStatus();e&&e.isRecording&&(this.isRecording=!0,this.recordingStatus="Recording active...",this.recordedCount=e.requestCount||0)},async updateRecordingStatus(){const e=await X.getRecordingStatus();e&&(this.recordedCount=e.requestCount||0)},async toggleRecording(){if(this.restrictedUrlWarning)this.recordingStatus="Cannot record from this page type";else try{if(this.isRecording){this.recordingStatus="Stopping recording...";const e=await X.stopRecording();e?(this.recordedRequests=e.data||[],this.isRecording=!1,"error"===e.status?(this.recordingStatus=`Error: ${e.error||"Unknown error"}`,console.error("Error stopping recording:",e.error)):"warning"===e.status?(this.recordingStatus=`Warning: ${e.message||"Recording stopped with warnings"}`,console.warn("Warning when stopping recording:",e.message)):this.recordingStatus="Recording stopped"):(this.isRecording=!1,this.recordingStatus="Recording stopped with issues",console.error("Error stopping recording: Empty response"))}else{this.recordingStatus="Initializing recording...";const e=await X.startRecording();e&&e.status&&!e.error?(this.isRecording=!0,this.recordingStatus="Recording active..."):this.recordingStatus=`Error: ${e.error||"Failed to start recording"}`}}catch(e){this.recordingStatus="Error while recording",console.error("Recording error:",e)}},async exportRecording(){try{await X.exportAsOpenAPI(this.recordedRequests)}catch(e){console.error("Error exporting recording:",e),this.recordingStatus=`Export error: ${e.message}`}},clearRecordings(){this.recordedRequests=[],this.recordingStatus="Data cleared"},toggleDetails(e){this.expandedRequest=this.expandedRequest===e?null:e},updateRequest(e,t){this.recordedRequests[e]=t,this.recordedRequests=[...this.recordedRequests]},async openReplayInNewTab(){if(!this.isOpeningReplayTab){this.isOpeningReplayTab=!0;try{const e=await X.openReplayInNewTab(this.recordedRequests||[]);e&&e.success||(console.error("Error opening replay tab:",e?.error),this.recordingStatus=`Error: ${e?.error||"Failed to open replay tab"}`)}catch(e){console.error("Error opening replay tab:",e),this.recordingStatus=`Error opening replay tab: ${e.message||"Unknown error"}`}finally{this.isOpeningReplayTab=!1}}},async checkCurrentPageCompatibility(){try{const e=await chrome.tabs.query({active:!0,currentWindow:!0});if(!e||!e.length)return;const t=e[0];this.activeTabId=t.id,this.activeTabUrl=t.url||"",this.restrictedUrlWarning=U(this.activeTabUrl),this.restrictedUrlWarning&&(this.recordingStatus="Recording not available on this page")}catch(e){console.error("Error checking page compatibility:",e)}},getMethodColor(e){const t={GET:"primary",POST:"success",PUT:"warning",DELETE:"error",PATCH:"info"};return t[e]||"grey"},getStatusColor(e){const t=parseInt(e);return t>=200&&t<300?"success":t>=300&&t<400?"info":t>=400&&t<500?"warning":t>=500?"error":"grey"},addVariableCapture(e){const t=this.expandedRequest;null!==t&&(this.recordedRequests[t].variableCapture||(this.recordedRequests[t].variableCapture=[]),this.recordedRequests[t].variableCapture.push(e),this.recordedRequests=[...this.recordedRequests])},showError(e){this.recordingStatus=e,console.error(e)}}};const B=(0,y.A)(j,[["render",u],["__scopeId","data-v-e3cd47b8"]]);var z=B;const G={class:"replay-tab"},Q={class:"ultra-compact-header"},J={class:"header-with-tabs"},M={class:"steps-container"};function H(e,t,r,a,o,i){const n=(0,s.g2)("replay-header"),u=(0,s.g2)("v-chip"),c=(0,s.g2)("v-spacer"),d=(0,s.g2)("v-tab"),p=(0,s.g2)("v-tabs"),g=(0,s.g2)("v-card-title"),b=(0,s.g2)("v-card-subtitle"),m=(0,s.g2)("execution-options"),v=(0,s.g2)("steps-list"),h=(0,s.g2)("v-window-item"),f=(0,s.g2)("variables-tab"),y=(0,s.g2)("v-window"),k=(0,s.g2)("v-card"),x=(0,s.g2)("v-fade-transition"),S=(0,s.g2)("v-icon"),R=(0,s.g2)("v-btn"),w=(0,s.g2)("v-container");return(0,s.uX)(),(0,s.CE)("div",G,[(0,s.bF)(w,{fluid:"",class:"replay-tab-container"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{"execution-status":o.executionStatus,"auto-loaded-data":o.autoLoadedData,onLoadFile:i.loadScenarioFile,onClearData:i.clearAllReplayData},null,8,["execution-status","auto-loaded-data","onLoadFile","onClearData"]),(0,s.bF)(x,null,{default:(0,s.k6)((()=>[o.scenario||o.recordedRequestsData?((0,s.uX)(),(0,s.Wv)(k,{key:0,flat:"",class:"mt-1 scenario-card"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",Q,[(0,s.Lk)("div",J,[(0,s.bF)(g,{class:"text-body-1 py-1 px-3 font-weight-bold"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(o.scenario?.info?.title||"Recently Recorded Scenario")+" ",1),(0,s.bF)(u,{color:"primary",variant:"flat",size:"x-small",class:"ml-2"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(o.scenarioSteps.length)+" steps ",1)])),_:1}),(0,s.bF)(c),(0,s.bF)(p,{modelValue:o.activeTab,"onUpdate:modelValue":t[0]||(t[0]=e=>o.activeTab=e),density:"compact",color:"primary",class:"tabs-right"},{default:(0,s.k6)((()=>[(0,s.bF)(d,{value:"replay"},{default:(0,s.k6)((()=>t[10]||(t[10]=[(0,s.eW)("Replay")]))),_:1}),(0,s.bF)(d,{value:"variables"},{default:(0,s.k6)((()=>t[11]||(t[11]=[(0,s.eW)("Variables")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),o.scenario?.info?.description||!o.scenario?((0,s.uX)(),(0,s.Wv)(b,{key:0,class:"text-caption pt-0 pb-1 px-3"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(o.scenario?.info?.description||"This is your recently recorded scenario ready for replay."),1)])),_:1})):(0,s.Q3)("",!0)]),(0,s.bF)(y,{modelValue:o.activeTab,"onUpdate:modelValue":t[7]||(t[7]=e=>o.activeTab=e)},{default:(0,s.k6)((()=>[(0,s.bF)(h,{value:"replay"},{default:(0,s.k6)((()=>[(0,s.bF)(m,{"stop-on-error":o.executionOptions.stopOnError,"onUpdate:stopOnError":t[1]||(t[1]=e=>o.executionOptions.stopOnError=e),"step-interval":o.executionOptions.stepInterval,"onUpdate:stepInterval":t[2]||(t[2]=e=>o.executionOptions.stepInterval=e),"error-on-capture":o.executionOptions.errorOnCapture,"onUpdate:errorOnCapture":t[3]||(t[3]=e=>o.executionOptions.errorOnCapture=e),"show-runtime-progress":o.executionOptions.showRuntimeProgress,"onUpdate:showRuntimeProgress":t[4]||(t[4]=e=>o.executionOptions.showRuntimeProgress=e),"base-url":o.executionOptions.baseUrl,"onUpdate:baseUrl":t[5]||(t[5]=e=>o.executionOptions.baseUrl=e),"global-variables":o.executionOptions.globalVariables,"onUpdate:globalVariables":t[6]||(t[6]=e=>o.executionOptions.globalVariables=e),"is-replaying":o.isReplaying,onStartReplay:i.startReplay,onClearResults:i.clearResults,onRemoveGlobalVariable:i.removeGlobalVariableFromSteps,class:"mt-1"},null,8,["stop-on-error","step-interval","error-on-capture","show-runtime-progress","base-url","global-variables","is-replaying","onStartReplay","onClearResults","onRemoveGlobalVariable"]),(0,s.Lk)("div",M,[(0,s.bF)(v,{steps:o.scenarioSteps,"expanded-step":o.expandedStep,"is-replaying":o.isReplaying,results:o.replayResults,"current-step-index":o.currentStepIndex,"show-runtime-progress":o.executionOptions.showRuntimeProgress,"execution-options":o.executionOptions,onToggleStep:i.toggleStepDetails,onToggleAllSteps:i.toggleAllSteps,onUpdateStep:i.updateStep,onExportResults:i.exportReplayResults,onGeneratePdf:i.generatePdfReport},null,8,["steps","expanded-step","is-replaying","results","current-step-index","show-runtime-progress","execution-options","onToggleStep","onToggleAllSteps","onUpdateStep","onExportResults","onGeneratePdf"])])])),_:1}),(0,s.bF)(h,{value:"variables"},{default:(0,s.k6)((()=>[(0,s.bF)(f,{steps:o.scenarioSteps,results:o.replayResults,"global-variables":o.executionOptions.globalVariables},null,8,["steps","results","global-variables"])])),_:1})])),_:1},8,["modelValue"])])])),_:1})):(0,s.Q3)("",!0)])),_:1}),o.scenario||o.recordedRequestsData?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(k,{key:0,class:"mt-4 pa-8 d-flex align-center justify-center flex-column"},{default:(0,s.k6)((()=>[(0,s.bF)(S,{icon:"mdi-file-document-outline",size:"64",color:"grey-lighten-1",class:"mb-4"}),t[13]||(t[13]=(0,s.Lk)("div",{class:"text-h6 mb-2"},"No scenario loaded",-1)),t[14]||(t[14]=(0,s.Lk)("div",{class:"text-body-2 text-grey mb-6"},"Please load an OpenAPI 3.0 file to get started or record a new session.",-1)),(0,s.bF)(R,{color:"primary","prepend-icon":"mdi-upload",onClick:t[8]||(t[8]=t=>e.$refs.fileInput.click())},{default:(0,s.k6)((()=>t[12]||(t[12]=[(0,s.eW)(" Load Scenario File ")]))),_:1}),(0,s.Lk)("input",{ref:"fileInput",type:"file",style:{display:"none"},onChange:t[9]||(t[9]=(...e)=>i.loadScenarioFile&&i.loadScenarioFile(...e)),accept:".json"},null,544)])),_:1}))])),_:1})])}r(8111),r(2489),r(7588),r(1701),r(8237);function K(e,t,r,a,o,l){const i=(0,s.g2)("v-toolbar-title"),n=(0,s.g2)("v-toolbar-subtitle"),u=(0,s.g2)("v-spacer"),c=(0,s.g2)("v-btn"),d=(0,s.g2)("v-toolbar"),p=(0,s.g2)("v-card");return(0,s.uX)(),(0,s.Wv)(p,{elevation:"1",class:"mb-3 header-card"},{default:(0,s.k6)((()=>[(0,s.bF)(d,{color:"primary",dark:"",density:"comfortable",class:"rounded header-toolbar"},{default:(0,s.k6)((()=>[(0,s.bF)(i,{class:"text-h5 font-weight-bold"},{default:(0,s.k6)((()=>t[1]||(t[1]=[(0,s.eW)(" Network Request Replay ")]))),_:1}),(0,s.bF)(n,{class:"text-caption mt-1"},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)(" Execute and analyze recorded network requests ")]))),_:1}),(0,s.bF)(u),(0,s.bF)(c,{color:"white",variant:"text",size:"small","prepend-icon":"mdi-upload",onClick:l.triggerFileInput},{default:(0,s.k6)((()=>t[3]||(t[3]=[(0,s.eW)(" Load File ")]))),_:1},8,["onClick"]),(0,s.Lk)("input",{ref:"fileInput",type:"file",style:{display:"none"},onChange:t[0]||(t[0]=(...e)=>l.onFileSelected&&l.onFileSelected(...e)),accept:".json"},null,544)])),_:1})])),_:1})}var Y={name:"ReplayHeader",props:{executionStatus:{type:String,default:"Ready to start"},autoLoadedData:{type:Boolean,default:!1}},methods:{triggerFileInput(){this.$refs.fileInput.click()},onFileSelected(e){const t=e.target?.files?.[0];t&&this.$emit("load-file",t)}}};const Z=(0,y.A)(Y,[["render",K],["__scopeId","data-v-733fdfd8"]]);var ee=Z;const te={class:"d-flex align-center"},re={class:"d-flex"},ae={class:"icon"},se={class:"icon"},oe={class:"text-h6 mb-3"},le={class:"d-flex align-center"},ie={class:"text-body-2"},ne={class:"text-caption text-grey"};function ue(e,t,r,o,i,n){const u=(0,s.g2)("v-icon"),c=(0,s.g2)("v-card-title"),d=(0,s.g2)("v-switch"),p=(0,s.g2)("v-col"),g=(0,s.g2)("v-text-field"),b=(0,s.g2)("v-btn"),m=(0,s.g2)("v-row"),v=(0,s.g2)("v-card-text"),h=(0,s.g2)("v-card"),f=(0,s.g2)("v-select"),y=(0,s.g2)("v-form"),k=(0,s.g2)("v-divider"),x=(0,s.g2)("v-alert"),S=(0,s.g2)("v-chip"),R=(0,s.g2)("v-spacer"),w=(0,s.g2)("v-card-actions"),F=(0,s.g2)("v-dialog");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(h,{class:"mb-4",variant:"outlined"},{default:(0,s.k6)((()=>[(0,s.bF)(c,{class:"d-flex align-center"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{icon:"mdi-cog",class:"mr-2"}),t[13]||(t[13]=(0,s.eW)(" Execution Options "))])),_:1}),(0,s.bF)(v,null,{default:(0,s.k6)((()=>[(0,s.bF)(m,{class:"align-center justify-center"},{default:(0,s.k6)((()=>[(0,s.bF)(p,{cols:"12",sm:"6",md:"2",class:"d-flex align-center",style:{height:"56px"}},{default:(0,s.k6)((()=>[(0,s.bF)(d,{modelValue:i.localStopOnError,"onUpdate:modelValue":[t[0]||(t[0]=e=>i.localStopOnError=e),n.updateStopOnError],color:"error","hide-details":"",label:"Stop on Error",density:"comfortable"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,s.bF)(p,{md:"1.5",class:"d-none d-md-block"}),(0,s.bF)(p,{cols:"12",sm:"6",md:"2",class:"d-flex align-center",style:{height:"56px"}},{default:(0,s.k6)((()=>[(0,s.Lk)("div",null,[(0,s.bF)(d,{modelValue:i.localErrorOnCapture,"onUpdate:modelValue":[t[1]||(t[1]=e=>i.localErrorOnCapture=e),n.updateErrorOnCapture],color:"warning","hide-details":"",label:"Error on Capture",density:"comfortable"},null,8,["modelValue","onUpdate:modelValue"]),t[14]||(t[14]=(0,s.Lk)("div",{class:"text-caption text-grey"}," Déclenche une erreur si une variable est capturée ",-1))])])),_:1}),(0,s.bF)(p,{md:"1.5",class:"d-none d-md-block"}),(0,s.bF)(p,{cols:"12",sm:"6",md:"2",class:"d-flex align-center",style:{height:"56px"}},{default:(0,s.k6)((()=>[(0,s.Lk)("div",te,[t[15]||(t[15]=(0,s.Lk)("div",{class:"mr-2",style:{"font-size":"16px"}},"Intervalle (ms):",-1)),(0,s.bF)(g,{modelValue:i.localStepInterval,"onUpdate:modelValue":[t[2]||(t[2]=e=>i.localStepInterval=e),n.updateStepInterval],modelModifiers:{number:!0},type:"number",min:0,max:1e4,"hide-details":"",density:"comfortable",style:{width:"120px"},class:"mr-1"},null,8,["modelValue","onUpdate:modelValue"])])])),_:1}),(0,s.bF)(p,{md:"1.5",class:"d-none d-md-block"}),(0,s.bF)(p,{cols:"12",sm:"6",md:"2",class:"d-flex align-center",style:{height:"56px"}},{default:(0,s.k6)((()=>[(0,s.bF)(b,{color:"info","prepend-icon":"mdi-atom-variant",onClick:t[3]||(t[3]=e=>i.showGlobalVariablesDialog=!0),class:"global-vars-btn",size:"large"},{default:(0,s.k6)((()=>t[16]||(t[16]=[(0,s.eW)(" Global Variables ")]))),_:1})])),_:1}),(0,s.bF)(p,{cols:"12",sm:"12",md:"12",class:"d-flex align-center justify-space-between mt-3"},{default:(0,s.k6)((()=>[(0,s.bF)(g,{modelValue:i.localBaseUrl,"onUpdate:modelValue":[t[4]||(t[4]=e=>i.localBaseUrl=e),n.updateBaseUrl],label:"Base URL",placeholder:"http://example.com",hint:"Modifie la base URL pour toutes les requêtes","persistent-hint":"","prepend-icon":"mdi-earth",clearable:"",class:"mr-2",style:{"max-width":"500px"}},null,8,["modelValue","onUpdate:modelValue"]),(0,s.Lk)("div",re,[r.isReplaying?((0,s.uX)(),(0,s.Wv)(b,{key:0,color:"primary",loading:r.isReplaying,size:"large",class:"mr-2","prepend-icon":"mdi-play",onClick:t[5]||(t[5]=t=>e.$emit("start-replay"))},{default:(0,s.k6)((()=>t[17]||(t[17]=[(0,s.eW)(" Start Replay ")]))),_:1},8,["loading"])):((0,s.uX)(),(0,s.CE)("div",{key:1,class:"custom-animated-button mr-2",onClick:t[6]||(t[6]=(...e)=>n.startReplayWithAnimation&&n.startReplayWithAnimation(...e))},[t[19]||(t[19]=(0,s.Lk)("span",null,"Start Replay",-1)),(0,s.Lk)("div",ae,[(0,s.bF)(u,{class:"fa-play"},{default:(0,s.k6)((()=>t[18]||(t[18]=[(0,s.eW)("mdi-play")]))),_:1})])])),(0,s.Lk)("div",{class:"custom-animated-button clear-results-btn",onClick:t[7]||(t[7]=(...e)=>n.clearResultsWithAnimation&&n.clearResultsWithAnimation(...e))},[t[21]||(t[21]=(0,s.Lk)("span",null,"Clear Results",-1)),(0,s.Lk)("div",se,[(0,s.bF)(u,{class:"fa-remove"},{default:(0,s.k6)((()=>t[20]||(t[20]=[(0,s.eW)("mdi-delete")]))),_:1})])])])])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.bF)(F,{modelValue:i.showGlobalVariablesDialog,"onUpdate:modelValue":t[12]||(t[12]=e=>i.showGlobalVariablesDialog=e),"max-width":"800px"},{default:(0,s.k6)((()=>[(0,s.bF)(h,null,{default:(0,s.k6)((()=>[(0,s.bF)(c,{class:"bg-info text-white"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{start:"",icon:"mdi-variable",class:"mr-2"}),t[22]||(t[22]=(0,s.eW)(" Variables Globales "))])),_:1}),(0,s.bF)(v,{class:"pa-4"},{default:(0,s.k6)((()=>[t[26]||(t[26]=(0,s.Lk)("p",{class:"text-body-2 mb-4"}," Les variables globales seront disponibles pour toutes les requêtes. Vous pouvez ajouter des variables à capturer globalement. ",-1)),(0,s.bF)(y,{onSubmit:(0,a.D$)(n.addGlobalVariable,["prevent"])},{default:(0,s.k6)((()=>[(0,s.bF)(m,null,{default:(0,s.k6)((()=>[(0,s.bF)(p,{cols:"12",sm:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(g,{modelValue:i.newVariable.name,"onUpdate:modelValue":t[8]||(t[8]=e=>i.newVariable.name=e),label:"Nom de la variable",placeholder:"ma_variable",rules:[e=>!!e||"Le nom est requis"],required:""},null,8,["modelValue","rules"])])),_:1}),(0,s.bF)(p,{cols:"12",sm:"5"},{default:(0,s.k6)((()=>[(0,s.bF)(g,{modelValue:i.newVariable.regex,"onUpdate:modelValue":t[9]||(t[9]=e=>i.newVariable.regex=e),label:"Expression régulière",placeholder:"regex pour capturer la valeur",rules:[e=>!!e||"L'expression est requise"],required:""},null,8,["modelValue","rules"])])),_:1}),(0,s.bF)(p,{cols:"12",sm:"3"},{default:(0,s.k6)((()=>[(0,s.bF)(f,{modelValue:i.newVariable.source,"onUpdate:modelValue":t[10]||(t[10]=e=>i.newVariable.source=e),items:i.captureSourceOptions,label:"Source","item-title":"title","item-value":"value",required:""},null,8,["modelValue","items"])])),_:1}),(0,s.bF)(p,{cols:"12",class:"d-flex justify-end"},{default:(0,s.k6)((()=>[(0,s.bF)(b,{color:"primary",onClick:n.addGlobalVariable,disabled:!i.newVariable.name||!i.newVariable.regex,"prepend-icon":"mdi-plus"},{default:(0,s.k6)((()=>t[23]||(t[23]=[(0,s.eW)(" Ajouter la variable ")]))),_:1},8,["onClick","disabled"])])),_:1})])),_:1})])),_:1},8,["onSubmit"]),(0,s.bF)(k,{class:"my-4"}),(0,s.Lk)("h3",oe,"Variables globales ("+(0,l.v_)(i.localGlobalVariables.length)+")",1),0===i.localGlobalVariables.length?((0,s.uX)(),(0,s.Wv)(x,{key:0,type:"info",variant:"tonal",class:"mb-4"},{default:(0,s.k6)((()=>t[24]||(t[24]=[(0,s.eW)(" Aucune variable globale définie. Ajoutez une variable en utilisant le formulaire ci-dessus. ")]))),_:1})):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.localGlobalVariables,((e,r)=>((0,s.uX)(),(0,s.Wv)(h,{key:r,variant:"outlined",class:"mb-2 capture-card"},{default:(0,s.k6)((()=>[(0,s.bF)(v,{class:"d-flex justify-space-between align-center py-2"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",null,[(0,s.Lk)("div",le,[(0,s.bF)(S,{color:"info",size:"small",class:"mr-2"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.name),1)])),_:2},1024),(0,s.Lk)("span",ie,(0,l.v_)(e.regex),1)]),(0,s.Lk)("div",ne," Source: "+(0,l.v_)(n.getSourceLabel(e.source)),1)]),(0,s.bF)(b,{color:"error",icon:"",size:"small",variant:"text",onClick:e=>n.removeGlobalVariable(r)},{default:(0,s.k6)((()=>[(0,s.bF)(u,null,{default:(0,s.k6)((()=>t[25]||(t[25]=[(0,s.eW)("mdi-delete")]))),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,s.bF)(w,null,{default:(0,s.k6)((()=>[(0,s.bF)(R),(0,s.bF)(b,{color:"primary",onClick:n.saveGlobalVariables},{default:(0,s.k6)((()=>t[27]||(t[27]=[(0,s.eW)(" Enregistrer ")]))),_:1},8,["onClick"]),(0,s.bF)(b,{text:"",onClick:t[11]||(t[11]=e=>i.showGlobalVariablesDialog=!1)},{default:(0,s.k6)((()=>t[28]||(t[28]=[(0,s.eW)(" Fermer ")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}r(116);var ce={name:"ExecutionOptions",props:{stopOnError:{type:Boolean,default:!0},errorOnCapture:{type:Boolean,default:!1},stepInterval:{type:Number,default:1e3},isReplaying:{type:Boolean,default:!1},baseUrl:{type:String,default:""},globalVariables:{type:Array,default:()=>[]}},data(){return{localStopOnError:this.stopOnError,localErrorOnCapture:this.errorOnCapture,localStepInterval:this.stepInterval,localBaseUrl:this.baseUrl,localGlobalVariables:this.globalVariables?[...this.globalVariables]:[],buttonSuccess:!1,clearSuccess:!1,showGlobalVariablesDialog:!1,newVariable:{name:"",regex:"",source:"body"},captureSourceOptions:[{title:"Corps de la réponse",value:"body"},{title:"En-têtes de la réponse",value:"headers"},{title:"URL de la réponse",value:"url"}]}},watch:{stopOnError(e){this.localStopOnError=e},errorOnCapture(e){this.localErrorOnCapture=e},stepInterval(e){this.localStepInterval=e},baseUrl(e){this.localBaseUrl=e},globalVariables(e){this.localGlobalVariables=e?[...e]:[]}},methods:{updateStopOnError(e){this.$emit("update:stop-on-error",e)},updateErrorOnCapture(e){this.$emit("update:error-on-capture",e)},updateStepInterval(e){this.$emit("update:step-interval",e)},updateBaseUrl(e){this.$emit("update:base-url",e)},startReplayWithAnimation(){this.$emit("start-replay")},clearResultsWithAnimation(){this.$emit("clear-results")},addGlobalVariable(){this.newVariable.name&&this.newVariable.regex&&(this.localGlobalVariables.push({...this.newVariable}),this.newVariable.name="",this.newVariable.regex="")},removeGlobalVariable(e){const t=this.localGlobalVariables[e];this.localGlobalVariables.splice(e,1),this.$emit("remove-global-variable",t)},saveGlobalVariables(){this.$emit("update:global-variables",[...this.localGlobalVariables]),this.showGlobalVariablesDialog=!1,this.$root.$emit("show-snackbar",{text:"Variables globales enregistrées avec succès",color:"success",timeout:3e3})},getSourceLabel(e){const t=this.captureSourceOptions.find((t=>t.value===e));return t?t.title:e}}};const de=(0,y.A)(ce,[["render",ue],["__scopeId","data-v-472a0479"]]);var pe=de;const ge={class:"d-flex align-center"},be={class:"steps-scrollable-container"};function me(e,t,r,a,o,l){const i=(0,s.g2)("v-icon"),n=(0,s.g2)("v-btn"),u=(0,s.g2)("v-card-title"),c=(0,s.g2)("ResultsSummary"),d=(0,s.g2)("v-divider"),p=(0,s.g2)("StepItem"),g=(0,s.g2)("v-list"),b=(0,s.g2)("v-card"),m=(0,s.g2)("CaptureDialog"),v=(0,s.g2)("SubstitutionDialog");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(b,{class:"mb-4 steps-list-card",variant:"outlined"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"d-flex justify-space-between align-center steps-header"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",ge,[(0,s.bF)(i,{icon:"mdi-format-list-numbered",class:"mr-2"}),t[6]||(t[6]=(0,s.eW)(" Steps "))]),(0,s.Lk)("div",null,[(0,s.bF)(n,{size:"small",variant:"text",class:"mr-2",onClick:t[0]||(t[0]=t=>e.$emit("toggle-all-steps",!0))},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.eW)(" Enable All ")]))),_:1}),(0,s.bF)(n,{size:"small",variant:"text",class:"mr-2",onClick:t[1]||(t[1]=t=>e.$emit("toggle-all-steps",!1))},{default:(0,s.k6)((()=>t[8]||(t[8]=[(0,s.eW)(" Skip All ")]))),_:1}),a.hasResults?((0,s.uX)(),(0,s.Wv)(n,{key:0,color:"primary",variant:"text","prepend-icon":"mdi-export",size:"small",class:"mr-2",onClick:t[2]||(t[2]=t=>e.$emit("export-results"))},{default:(0,s.k6)((()=>t[9]||(t[9]=[(0,s.eW)(" Export ")]))),_:1})):(0,s.Q3)("",!0),a.hasResults?((0,s.uX)(),(0,s.Wv)(n,{key:1,color:"primary",variant:"text","prepend-icon":"mdi-file-pdf-box",size:"small",onClick:t[3]||(t[3]=t=>e.$emit("generate-pdf"))},{default:(0,s.k6)((()=>t[10]||(t[10]=[(0,s.eW)(" PDF Report ")]))),_:1})):(0,s.Q3)("",!0)])])),_:1}),a.hasResults?((0,s.uX)(),(0,s.Wv)(c,{key:0,steps:r.steps,results:r.results},null,8,["steps","results"])):(0,s.Q3)("",!0),(0,s.bF)(d),(0,s.Lk)("div",be,[(0,s.bF)(g,{class:"steps-list"},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.steps,((t,o)=>((0,s.uX)(),(0,s.Wv)(p,{key:o,step:t,index:o,"current-step-index":r.currentStepIndex,"is-replaying":r.isReplaying,"progress-status":a.progressStatus[o],results:r.results[o],expanded:r.expandedStep===o,"execution-options":r.executionOptions,onUpdateStep:t=>e.$emit("update-step",o,t),onToggleStep:t=>e.$emit("toggle-step",o),onOpenCaptureDialog:()=>a.openCaptureDialog(o),onOpenSubstitutionDialog:()=>a.openSubstitutionDialog(o)},null,8,["step","index","current-step-index","is-replaying","progress-status","results","expanded","execution-options","onUpdateStep","onToggleStep","onOpenCaptureDialog","onOpenSubstitutionDialog"])))),128))])),_:1})])])),_:1}),(0,s.bF)(m,{modelValue:a.showCaptureDialog,"onUpdate:modelValue":t[4]||(t[4]=e=>a.showCaptureDialog=e),form:a.captureForm,"source-options":a.captureSourceOptions,onSave:a.saveCapture},null,8,["modelValue","form","source-options","onSave"]),(0,s.bF)(v,{modelValue:a.showSubstitutionDialog,"onUpdate:modelValue":t[5]||(t[5]=e=>a.showSubstitutionDialog=e),form:a.substitutionForm,"available-steps":a.availableStepsForVariables,"get-available-variables":a.availableVariablesForStep,onSave:a.saveSubstitution},null,8,["modelValue","form","available-steps","get-available-variables","onSave"])],64)}const ve={class:"text-h4"},he={class:"text-h4 text-success"},fe={class:"text-h4 text-error"},ye={class:"text-h4 text-warning"};function ke(e,t,r,a,o,i){const n=(0,s.g2)("v-card"),u=(0,s.g2)("v-col"),c=(0,s.g2)("v-row"),d=(0,s.g2)("v-card-text");return(0,s.uX)(),(0,s.Wv)(d,{class:"results-summary"},{default:(0,s.k6)((()=>[(0,s.bF)(c,null,{default:(0,s.k6)((()=>[(0,s.bF)(u,{cols:"3"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{flat:"",class:"text-center pa-3"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",ve,(0,l.v_)(r.steps.length),1),t[0]||(t[0]=(0,s.Lk)("div",{class:"text-subtitle-2"},"Total Steps",-1))])),_:1})])),_:1}),(0,s.bF)(u,{cols:"3"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{flat:"",class:"text-center pa-3 bg-success-lighten-5"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",he,(0,l.v_)(a.successCount),1),t[1]||(t[1]=(0,s.Lk)("div",{class:"text-subtitle-2"},"Successful",-1))])),_:1})])),_:1}),(0,s.bF)(u,{cols:"3"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{flat:"",class:"text-center pa-3 bg-error-lighten-5"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",fe,(0,l.v_)(a.errorCount),1),t[2]||(t[2]=(0,s.Lk)("div",{class:"text-subtitle-2"},"Failed",-1))])),_:1})])),_:1}),(0,s.bF)(u,{cols:"3"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{flat:"",class:"text-center pa-3 bg-warning-lighten-5"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",ye,(0,l.v_)(a.skippedCount),1),t[3]||(t[3]=(0,s.Lk)("div",{class:"text-subtitle-2"},"Skipped",-1))])),_:1})])),_:1})])),_:1})])),_:1})}var xe={name:"ResultsSummary",props:{steps:{type:Array,required:!0},results:{type:Array,required:!0}},setup(e){const t=(0,s.EW)((()=>e.results.filter((e=>e&&"success"===e.status)).length)),r=(0,s.EW)((()=>e.results.filter((e=>e&&"error"===e.status)).length)),a=(0,s.EW)((()=>e.results.filter((e=>e&&"skipped"===e.status)).length));return{successCount:t,errorCount:r,skippedCount:a}}};const Se=(0,y.A)(xe,[["render",ke],["__scopeId","data-v-33ca9179"]]);var Re=Se;const we={key:0,class:"pa-4 mx-4 mt-2 mb-4 bg-grey-lighten-4 rounded"};function Fe(e,t,r,o,i,n){const u=(0,s.g2)("v-checkbox"),c=(0,s.g2)("v-progress-circular"),d=(0,s.g2)("v-icon"),p=(0,s.g2)("v-avatar"),g=(0,s.g2)("v-chip"),b=(0,s.g2)("v-list-item-title"),m=(0,s.g2)("v-list-item-subtitle"),v=(0,s.g2)("v-alert"),h=(0,s.g2)("v-btn"),f=(0,s.g2)("v-list-item"),y=(0,s.g2)("StepDetails"),k=(0,s.g2)("v-expand-transition");return(0,s.uX)(),(0,s.CE)("div",{class:(0,l.C4)(["list-item",{"list-item-disabled":r.step.skip,"list-item-success":"success"===o.getStepResultStatus(),"list-item-error":"error"===o.getStepResultStatus(),"list-item-in-progress":r.index===r.currentStepIndex&&r.isReplaying}])},[(0,s.bF)(f,{ripple:!1,onClick:t[3]||(t[3]=t=>e.$emit("toggle-step")),class:"step-item"},{prepend:(0,s.k6)((()=>[(0,s.bF)(u,{modelValue:o.localEnabled,"onUpdate:modelValue":t[0]||(t[0]=e=>o.localEnabled=e),"hide-details":"",density:"compact",color:"primary",disabled:r.isReplaying,onChange:o.updateStepEnabled,onClick:t[1]||(t[1]=(0,a.D$)((()=>{}),["stop"]))},null,8,["modelValue","disabled","onChange"]),r.index===r.currentStepIndex&&r.isReplaying?((0,s.uX)(),(0,s.Wv)(c,{key:0,indeterminate:"",color:"primary",size:"28",width:"3",class:"ml-2 step-progress-indicator pulse-animation"})):r.results?((0,s.uX)(),(0,s.Wv)(p,{key:1,color:o.getStatusColor(o.getStepResultStatus()),size:"small",class:"ml-2"},{default:(0,s.k6)((()=>[(0,s.bF)(d,{icon:o.getStatusIcon(o.getStepResultStatus()),color:"white",size:"small"},null,8,["icon"])])),_:1},8,["color"])):(0,s.Q3)("",!0)])),default:(0,s.k6)((()=>[(0,s.Lk)("div",null,[(0,s.bF)(b,{class:"d-flex align-center"},{default:(0,s.k6)((()=>[(0,s.bF)(g,{size:"small",color:o.getMethodColor(r.step.method),class:"mr-2"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(r.step.method),1)])),_:1},8,["color"]),(0,s.Lk)("span",{class:(0,l.C4)({"font-weight-bold":r.index===r.currentStepIndex&&r.isReplaying,"text-primary":r.index===r.currentStepIndex&&r.isReplaying})},(0,l.v_)(r.step.name||`Step ${r.index+1}`),3),r.index===r.currentStepIndex&&r.isReplaying?((0,s.uX)(),(0,s.Wv)(g,{key:0,size:"small",color:"primary",class:"ml-2 current-step-badge pulse-animation"},{default:(0,s.k6)((()=>[(0,s.bF)(d,{start:"",icon:"mdi-loading",size:"x-small",class:"rotating-icon"}),t[6]||(t[6]=(0,s.eW)(" EN COURS "))])),_:1})):(0,s.Q3)("",!0)])),_:1}),(0,s.bF)(m,{class:"text-truncate"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(r.step.url),1)])),_:1}),o.hasResultError()?((0,s.uX)(),(0,s.Wv)(v,{key:0,type:"error",variant:"tonal",density:"compact",class:"mt-2"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(o.getResultError()),1)])),_:1})):(0,s.Q3)("",!0)])])),append:(0,s.k6)((()=>[(0,s.bF)(h,{icon:"mdi-chevron-down",variant:"text",size:"small",class:(0,l.C4)({"rotate-icon":r.expanded}),onClick:t[2]||(t[2]=(0,a.D$)((t=>e.$emit("toggle-step")),["stop"]))},null,8,["class"])])),_:1}),(0,s.bF)(k,null,{default:(0,s.k6)((()=>[r.expanded?((0,s.uX)(),(0,s.CE)("div",we,[(0,s.bF)(y,{step:r.step,index:r.index,results:r.results,"execution-options":r.executionOptions,"source-options":o.captureSourceOptions,onOpenCaptureDialog:t[4]||(t[4]=t=>e.$emit("open-capture-dialog")),onOpenSubstitutionDialog:t[5]||(t[5]=t=>e.$emit("open-substitution-dialog")),onUpdateStep:o.updateChildStep},null,8,["step","index","results","execution-options","source-options","onUpdateStep"])])):(0,s.Q3)("",!0)])),_:1})],2)}var Ce=r(2040);const _e={key:0},Ve={class:"text-primary"},Ee={key:1},qe={key:2},Le={class:"text-capitalize"},Oe={class:"font-weight-bold"},De={key:0,class:"text-error"},We={class:"font-weight-bold"},Ue={key:0},Ie={key:1},Te={key:2};function Ae(e,t,r,o,i,n){const u=(0,s.g2)("v-tab"),c=(0,s.g2)("v-tabs"),d=(0,s.g2)("v-table"),p=(0,s.g2)("v-card"),g=(0,s.g2)("v-window-item"),b=(0,s.g2)("v-list-item-title"),m=(0,s.g2)("v-list-item-subtitle"),v=(0,s.g2)("v-list-item"),h=(0,s.g2)("v-list"),f=(0,s.g2)("v-btn"),y=(0,s.g2)("v-icon"),k=(0,s.g2)("v-card-title"),x=(0,s.g2)("v-chip"),S=(0,s.g2)("v-card-text"),R=(0,s.g2)("v-col"),w=(0,s.g2)("v-row"),F=(0,s.g2)("v-window");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(c,{modelValue:o.activeTab,"onUpdate:modelValue":t[6]||(t[6]=e=>o.activeTab=e),density:"comfortable",class:"mb-2",onClick:t[7]||(t[7]=(0,a.D$)((()=>{}),["stop"]))},{default:(0,s.k6)((()=>[(0,s.bF)(u,{value:"details",onClick:t[0]||(t[0]=(0,a.D$)((()=>{}),["stop"]))},{default:(0,s.k6)((()=>t[12]||(t[12]=[(0,s.eW)("Step Details")]))),_:1}),(0,s.bF)(u,{value:"request",onClick:t[1]||(t[1]=(0,a.D$)((()=>{}),["stop"]))},{default:(0,s.k6)((()=>t[13]||(t[13]=[(0,s.eW)("Request")]))),_:1}),o.hasResult&&r.results.response?((0,s.uX)(),(0,s.Wv)(u,{key:0,value:"response",onClick:t[2]||(t[2]=(0,a.D$)((()=>{}),["stop"]))},{default:(0,s.k6)((()=>t[14]||(t[14]=[(0,s.eW)("Response")]))),_:1})):(0,s.Q3)("",!0),(0,s.bF)(u,{value:"captures",onClick:t[3]||(t[3]=(0,a.D$)((()=>{}),["stop"]))},{default:(0,s.k6)((()=>t[15]||(t[15]=[(0,s.eW)("Variable Captures")]))),_:1}),(0,s.bF)(u,{value:"substitutions",onClick:t[4]||(t[4]=(0,a.D$)((()=>{}),["stop"]))},{default:(0,s.k6)((()=>t[16]||(t[16]=[(0,s.eW)("Substitutions")]))),_:1}),o.hasResult&&o.hasCapturedVariables?((0,s.uX)(),(0,s.Wv)(u,{key:1,value:"captured",onClick:t[5]||(t[5]=(0,a.D$)((()=>{}),["stop"]))},{default:(0,s.k6)((()=>t[17]||(t[17]=[(0,s.eW)("Captured Vars")]))),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue"]),(0,s.bF)(F,{modelValue:o.activeTab,"onUpdate:modelValue":t[10]||(t[10]=e=>o.activeTab=e),onClick:t[11]||(t[11]=(0,a.D$)((()=>{}),["stop"]))},{default:(0,s.k6)((()=>[(0,s.bF)(g,{value:"details"},{default:(0,s.k6)((()=>[(0,s.bF)(p,{variant:"flat",class:"pa-2"},{default:(0,s.k6)((()=>[(0,s.bF)(d,{density:"compact"},{default:(0,s.k6)((()=>[(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[t[18]||(t[18]=(0,s.Lk)("td",{class:"font-weight-bold"},"URL:",-1)),(0,s.Lk)("td",null,(0,l.v_)(r.step.url),1)]),r.executionOptions&&r.executionOptions.baseUrl?((0,s.uX)(),(0,s.CE)("tr",_e,[t[19]||(t[19]=(0,s.Lk)("td",{class:"font-weight-bold"},"URL Modifiée:",-1)),(0,s.Lk)("td",Ve,(0,l.v_)(o.getModifiedUrl(r.step.url,r.executionOptions.baseUrl)),1)])):(0,s.Q3)("",!0),(0,s.Lk)("tr",null,[t[20]||(t[20]=(0,s.Lk)("td",{class:"font-weight-bold"},"Method:",-1)),(0,s.Lk)("td",null,(0,l.v_)(r.step.method),1)]),r.step.description?((0,s.uX)(),(0,s.CE)("tr",Ee,[t[21]||(t[21]=(0,s.Lk)("td",{class:"font-weight-bold"},"Description:",-1)),(0,s.Lk)("td",null,(0,l.v_)(r.step.description),1)])):(0,s.Q3)("",!0),o.hasResult?((0,s.uX)(),(0,s.CE)("tr",qe,[t[22]||(t[22]=(0,s.Lk)("td",{class:"font-weight-bold"},"Status:",-1)),(0,s.Lk)("td",Le,(0,l.v_)(o.getResultStatus()),1)])):(0,s.Q3)("",!0)])])),_:1})])),_:1})])),_:1}),(0,s.bF)(g,{value:"request"},{default:(0,s.k6)((()=>[(0,s.bF)(p,{variant:"flat",class:"pa-2"},{default:(0,s.k6)((()=>[(0,s.Lk)("pre",null,(0,l.v_)(o.hasResult&&r.results.request?o.formatRequestForDisplay(r.results.request):o.formatStepRequestForDisplay(r.step)),1)])),_:1})])),_:1}),o.hasResult&&r.results.response?((0,s.uX)(),(0,s.Wv)(g,{key:0,value:"response"},{default:(0,s.k6)((()=>[(0,s.bF)(p,{variant:"flat",class:"pa-2"},{default:(0,s.k6)((()=>[(0,s.Lk)("pre",null,(0,l.v_)(o.formatJson(r.results.response)),1)])),_:1})])),_:1})):(0,s.Q3)("",!0),o.hasResult&&o.hasCapturedVariables?((0,s.uX)(),(0,s.Wv)(g,{key:1,value:"captured"},{default:(0,s.k6)((()=>[(0,s.bF)(p,{variant:"flat",class:"pa-2"},{default:(0,s.k6)((()=>[(0,s.bF)(h,{density:"compact"},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.results.capturedVariables,((e,t)=>((0,s.uX)(),(0,s.Wv)(v,{key:t},{default:(0,s.k6)((()=>[(0,s.bF)(b,{class:"font-weight-bold"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(t),1)])),_:2},1024),(0,s.bF)(m,null,{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})):(0,s.Q3)("",!0),(0,s.bF)(g,{value:"captures"},{default:(0,s.k6)((()=>[(0,s.bF)(p,{variant:"flat",class:"pa-2"},{default:(0,s.k6)((()=>[t[30]||(t[30]=(0,s.Lk)("div",{class:"text-subtitle-2 mb-2"},"Définir des captures de variables par regex",-1)),t[31]||(t[31]=(0,s.Lk)("p",{class:"text-caption mb-4"}," Créez des expressions régulières pour capturer des données depuis la réponse. Les variables capturées seront disponibles pour les prochaines étapes. ",-1)),(0,s.bF)(f,{color:"primary",variant:"outlined","prepend-icon":"mdi-plus",class:"mb-4",onClick:t[8]||(t[8]=(0,a.D$)((t=>e.$emit("open-capture-dialog")),["stop"]))},{default:(0,s.k6)((()=>t[23]||(t[23]=[(0,s.eW)(" Ajouter une capture ")]))),_:1}),(0,s.bF)(w,null,{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.getStepCaptures(),((e,r)=>((0,s.uX)(),(0,s.Wv)(R,{cols:"12",md:"6",lg:"4",key:r},{default:(0,s.k6)((()=>[(0,s.bF)(p,{class:"mb-2 capture-card",outlined:""},{default:(0,s.k6)((()=>[(0,s.bF)(k,{class:"d-flex justify-space-between align-center py-2"},{default:(0,s.k6)((()=>[(0,s.Lk)("span",Oe,(0,l.v_)(e.name),1),(0,s.bF)(f,{icon:"",size:"small",color:"error",onClick:(0,a.D$)((e=>o.removeCapture(r)),["stop"])},{default:(0,s.k6)((()=>[(0,s.bF)(y,null,{default:(0,s.k6)((()=>t[24]||(t[24]=[(0,s.eW)("mdi-delete")]))),_:1})])),_:2},1032,["onClick"])])),_:2},1024),(0,s.bF)(S,{class:"py-1"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",null,[t[25]||(t[25]=(0,s.Lk)("strong",null,"Regex:",-1)),(0,s.eW)(" "+(0,l.v_)(e.regex),1)]),(0,s.Lk)("div",null,[t[26]||(t[26]=(0,s.Lk)("strong",null,"Source:",-1)),(0,s.eW)(" "+(0,l.v_)(o.getSourceLabel(e.source)),1)]),(0,s.Lk)("div",null,[t[27]||(t[27]=(0,s.Lk)("strong",null,"Obligatoire:",-1)),t[28]||(t[28]=(0,s.eW)()),(0,s.bF)(x,{size:"x-small",color:e.required?"error":"info"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.required?"Oui":"Non"),1)])),_:2},1032,["color"])]),e.errorOnCapture?((0,s.uX)(),(0,s.CE)("div",De,[t[29]||(t[29]=(0,s.Lk)("strong",null,"Erreur:",-1)),(0,s.eW)(" "+(0,l.v_)(e.errorOnCapture),1)])):(0,s.Q3)("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),(0,s.bF)(g,{value:"substitutions"},{default:(0,s.k6)((()=>[(0,s.bF)(p,{variant:"flat",class:"pa-2"},{default:(0,s.k6)((()=>[t[38]||(t[38]=(0,s.Lk)("div",{class:"text-subtitle-2 mb-2"},"Définir des substitutions de variables",-1)),t[39]||(t[39]=(0,s.Lk)("p",{class:"text-caption mb-4"}," Créez des règles de substitution pour remplacer des valeurs dans la requête par des variables capturées précédemment. ",-1)),(0,s.bF)(f,{color:"primary",variant:"outlined","prepend-icon":"mdi-plus",class:"mb-4",onClick:t[9]||(t[9]=(0,a.D$)((t=>e.$emit("open-substitution-dialog")),["stop"]))},{default:(0,s.k6)((()=>t[32]||(t[32]=[(0,s.eW)(" Ajouter une substitution ")]))),_:1}),(0,s.bF)(w,null,{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.getStepSubstitutions(),((e,r)=>((0,s.uX)(),(0,s.Wv)(R,{cols:"12",md:"6",lg:"4",key:r},{default:(0,s.k6)((()=>[(0,s.bF)(p,{class:"mb-2 substitution-card",outlined:""},{default:(0,s.k6)((()=>[(0,s.bF)(k,{class:"d-flex justify-space-between align-center py-2"},{default:(0,s.k6)((()=>[(0,s.Lk)("span",We,(0,l.v_)(e.targetVariable||"Substitution"),1),(0,s.bF)(f,{icon:"",size:"small",color:"error",onClick:(0,a.D$)((e=>o.removeSubstitution(r)),["stop"])},{default:(0,s.k6)((()=>[(0,s.bF)(y,null,{default:(0,s.k6)((()=>t[33]||(t[33]=[(0,s.eW)("mdi-delete")]))),_:1})])),_:2},1032,["onClick"])])),_:2},1024),(0,s.bF)(S,{class:"py-1"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",null,[t[34]||(t[34]=(0,s.Lk)("strong",null,"Regex:",-1)),(0,s.eW)(" "+(0,l.v_)(e.regex),1)]),e.targetVariable?((0,s.uX)(),(0,s.CE)("div",Ue,[t[35]||(t[35]=(0,s.Lk)("strong",null,"Remplacer par:",-1)),(0,s.eW)(" "+(0,l.v_)(e.targetVariable),1)])):(0,s.Q3)("",!0),void 0!==e.sourceStep?((0,s.uX)(),(0,s.CE)("div",Ie,[t[36]||(t[36]=(0,s.Lk)("strong",null,"De l'étape:",-1)),(0,s.eW)(" "+(0,l.v_)(e.sourceStep+1),1)])):(0,s.Q3)("",!0),e.value?((0,s.uX)(),(0,s.CE)("div",Te,[t[37]||(t[37]=(0,s.Lk)("strong",null,"Valeur fixe:",-1)),(0,s.eW)(" "+(0,l.v_)(e.value),1)])):(0,s.Q3)("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}var $e={name:"StepDetails",props:{step:{type:Object,required:!0},index:{type:Number,required:!0},results:{type:Object,default:null},executionOptions:{type:Object,default:()=>({})},sourceOptions:{type:Array,default:()=>[{title:"Corps de la réponse",value:"body"},{title:"En-têtes de la réponse",value:"headers"},{title:"URL de la réponse",value:"url"}]}},emits:["update-step","open-capture-dialog","open-substitution-dialog"],setup(e,{emit:t}){const r=(0,Ce.KR)("details"),a=(0,s.EW)((()=>!!e.results)),o=(0,s.EW)((()=>e.results&&e.results.capturedVariables&&Object.keys(e.results.capturedVariables).length>0)),l=()=>e.results?e.results.error?"error":e.results.status||"success":null,i=()=>e.step.variableCaptures?e.step.variableCaptures:(t("update-step",{...e.step,variableCaptures:[]}),[]),n=r=>{const a=[...e.step.variableCaptures||[]];a.splice(r,1),t("update-step",{...e.step,variableCaptures:a})},u=t=>{const r=e.sourceOptions.find((e=>e.value===t));return r?r.title:t},c=()=>e.step.variableSubstitutions?e.step.variableSubstitutions:(t("update-step",{...e.step,variableSubstitutions:[]}),[]),d=r=>{const a=[...e.step.variableSubstitutions||[]];a.splice(r,1),t("update-step",{...e.step,variableSubstitutions:a})},p=(e,t)=>{if(!t||!e)return e;try{const a=new URL(e);let s;try{s=t.startsWith("http://")||t.startsWith("https://")?new URL(t):new URL("http://"+t)}catch(r){return console.warn("Invalid baseUrl format:",t,r),e}const o=new URL(a.pathname+a.search+a.hash,s.origin);return o.href}catch(r){return console.warn("Error applying baseUrl:",r),e}},g=e=>{if(!e)return"No request data available";try{const r={url:e.url||"",method:e.method||"",headers:e.headers||e.requestHeaders||{}};if(e.queryParameters)r.queryParameters=e.queryParameters;else if(e.url&&e.url.includes("?"))try{const t=new URL(e.url),a={};t.searchParams.forEach(((e,t)=>{a[t]=e})),r.queryParameters=a}catch(t){console.warn("Error parsing URL query parameters:",t)}if(e.body||e.requestBody)try{const t=e.body||e.requestBody;if("string"===typeof t)try{r.body=JSON.parse(t)}catch{r.body=t}else r.body=t}catch(t){r.body="Error parsing request body",console.error("Error parsing body:",t)}return JSON.stringify(r,null,2)}catch(t){return console.error("Error formatting request for display:",t),`Error formatting request: ${t.message}`}},b=e=>{if(!e)return"No step data available";try{const r={url:e.url||"",method:e.method||"",headers:e.headers||{}};if(e.queryParameters)r.queryParameters=e.queryParameters;else if(e.url&&e.url.includes("?"))try{const t=new URL(e.url),a={};t.searchParams.forEach(((e,t)=>{a[t]=e})),r.queryParameters=a}catch(t){console.warn("Error parsing URL query parameters:",t)}return e.body?r.body=m(e.body):e.requestBody?r.body=m(e.requestBody):e._originalRequestBody?r.body=m(e._originalRequestBody):e.request&&e.request.body&&(r.body=m(e.request.body)),JSON.stringify(r,null,2)}catch(t){return console.error("Error formatting step for display:",t),`Error formatting step: ${t.message}`}},m=e=>{if(e&&e.content&&e.content["application/json"])return e;if("string"===typeof e)try{return JSON.parse(e)}catch{return e}return e},v=e=>{if(!e)return"No data available";try{if("object"===typeof e)return JSON.stringify(e,null,2);if("string"!==typeof e)return String(e);try{const t=JSON.parse(e);return JSON.stringify(t,null,2)}catch{return e}}catch(t){return console.error("Error formatting JSON:",t),`Error formatting data: ${t.message}`}};return{activeTab:r,hasResult:a,hasCapturedVariables:o,getResultStatus:l,getStepCaptures:i,removeCapture:n,getSourceLabel:u,getStepSubstitutions:c,removeSubstitution:d,getModifiedUrl:p,formatRequestForDisplay:g,formatStepRequestForDisplay:b,formatJson:v}}};const Ne=(0,y.A)($e,[["render",Ae],["__scopeId","data-v-1ebe5535"]]);var Pe=Ne,Xe={name:"StepItem",components:{StepDetails:Pe},props:{step:{type:Object,required:!0},index:{type:Number,required:!0},results:{type:Object,default:null},currentStepIndex:{type:Number,default:-1},isReplaying:{type:Boolean,default:!1},progressStatus:{type:String,default:null},expanded:{type:Boolean,default:!1},executionOptions:{type:Object,default:()=>({})}},emits:["toggle-step","update-step","open-capture-dialog","open-substitution-dialog"],setup(e,{emit:t}){const r=(0,Ce.KR)(e.step.enabled),a=[{title:"Corps de la réponse",value:"body"},{title:"En-têtes de la réponse",value:"headers"},{title:"URL de la réponse",value:"url"}];(0,s.wB)((()=>e.step.enabled),(e=>{r.value=e}));const o=()=>{t("update-step",{enabled:r.value,skip:!r.value})},l=e=>{t("update-step",{...e})},i=e=>{const t={GET:"primary",POST:"success",PUT:"warning",DELETE:"error",PATCH:"info"};return t[e]||"grey"},n=()=>e.progressStatus?e.progressStatus:e.results?e.results.error?"error":"success":null,u=()=>e.results&&"error"===e.results.status&&e.results.error,c=()=>u()?e.results.error:"",d=e=>"success"===e?"success":"error"===e?"error":"skipped"===e?"warning":"in-progress"===e?"info":"grey",p=e=>"success"===e?"mdi-check":"error"===e?"mdi-close":"skipped"===e?"mdi-skip-next":"in-progress"===e?"mdi-loading":"mdi-help";return{localEnabled:r,captureSourceOptions:a,updateStepEnabled:o,updateChildStep:l,getMethodColor:i,getStepResultStatus:n,hasResultError:u,getResultError:c,getStatusColor:d,getStatusIcon:p}}};const je=(0,y.A)(Xe,[["render",Fe],["__scopeId","data-v-35fc3274"]]);var Be=je;function ze(e,t,r,o,l,i){const n=(0,s.g2)("v-card-title"),u=(0,s.g2)("v-text-field"),c=(0,s.g2)("v-select"),d=(0,s.g2)("v-switch"),p=(0,s.g2)("v-form"),g=(0,s.g2)("v-card-text"),b=(0,s.g2)("v-spacer"),m=(0,s.g2)("v-btn"),v=(0,s.g2)("v-card-actions"),h=(0,s.g2)("v-card"),f=(0,s.g2)("v-dialog");return(0,s.uX)(),(0,s.Wv)(f,{"model-value":r.modelValue,"onUpdate:modelValue":t[5]||(t[5]=t=>e.$emit("update:model-value",t)),"max-width":"500px"},{default:(0,s.k6)((()=>[(0,s.bF)(h,null,{default:(0,s.k6)((()=>[(0,s.bF)(n,{class:"bg-primary text-white"},{default:(0,s.k6)((()=>t[6]||(t[6]=[(0,s.eW)("Nouvelle capture de variable")]))),_:1}),(0,s.bF)(g,null,{default:(0,s.k6)((()=>[(0,s.bF)(p,{ref:"form",onSubmit:(0,a.D$)(o.handleSave,["prevent"])},{default:(0,s.k6)((()=>[(0,s.bF)(u,{modelValue:o.localForm.name,"onUpdate:modelValue":t[0]||(t[0]=e=>o.localForm.name=e),label:"Nom de variable",rules:[e=>!!e||"Le nom est requis"],required:""},null,8,["modelValue","rules"]),(0,s.bF)(u,{modelValue:o.localForm.regex,"onUpdate:modelValue":t[1]||(t[1]=e=>o.localForm.regex=e),label:"Expression régulière",rules:[e=>!!e||"L'expression est requise"],required:""},null,8,["modelValue","rules"]),(0,s.bF)(c,{modelValue:o.localForm.source,"onUpdate:modelValue":t[2]||(t[2]=e=>o.localForm.source=e),items:r.sourceOptions,label:"Source","item-title":"title","item-value":"value",required:""},null,8,["modelValue","items"]),(0,s.bF)(d,{modelValue:o.localForm.required,"onUpdate:modelValue":t[3]||(t[3]=e=>o.localForm.required=e),color:"error",label:"Capture obligatoire"},null,8,["modelValue"])])),_:1},8,["onSubmit"])])),_:1}),(0,s.bF)(v,null,{default:(0,s.k6)((()=>[(0,s.bF)(b),(0,s.bF)(m,{text:"",onClick:t[4]||(t[4]=t=>e.$emit("update:model-value",!1))},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.eW)("Annuler")]))),_:1}),(0,s.bF)(m,{color:"primary",onClick:o.handleSave},{default:(0,s.k6)((()=>t[8]||(t[8]=[(0,s.eW)("Enregistrer")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["model-value"])}var Ge={name:"CaptureDialog",props:{modelValue:{type:Boolean,required:!0},form:{type:Object,required:!0},sourceOptions:{type:Array,required:!0}},emits:["update:model-value","save"],setup(e,{emit:t}){const r=(0,Ce.KR)(null),a=(0,Ce.KR)({...e.form});(0,s.wB)((()=>e.form),(e=>{a.value={...e}}),{deep:!0}),(0,s.wB)((()=>e.modelValue),(e=>{e&&console.log("CaptureDialog opened with form:",a.value)})),(0,s.sV)((()=>{console.log("CaptureDialog mounted with form:",e.form)}));const o=()=>{if(console.log("Save button clicked in CaptureDialog with form data:",a.value),!a.value.name||!a.value.regex)return void console.error("Validation failed: name or regex is missing");const e={...a.value};console.log("Emitting save event with data:",e),t("save",e),t("update:model-value",!1)};return{form:r,localForm:a,handleSave:o}}};const Qe=(0,y.A)(Ge,[["render",ze]]);var Je=Qe;function Me(e,t,r,o,l,i){const n=(0,s.g2)("v-card-title"),u=(0,s.g2)("v-text-field"),c=(0,s.g2)("v-radio"),d=(0,s.g2)("v-radio-group"),p=(0,s.g2)("v-select"),g=(0,s.g2)("v-form"),b=(0,s.g2)("v-card-text"),m=(0,s.g2)("v-spacer"),v=(0,s.g2)("v-btn"),h=(0,s.g2)("v-card-actions"),f=(0,s.g2)("v-card"),y=(0,s.g2)("v-dialog");return(0,s.uX)(),(0,s.Wv)(y,{"model-value":r.modelValue,"onUpdate:modelValue":t[6]||(t[6]=t=>e.$emit("update:model-value",t)),"max-width":"600px"},{default:(0,s.k6)((()=>[(0,s.bF)(f,null,{default:(0,s.k6)((()=>[(0,s.bF)(n,{class:"bg-primary text-white"},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.eW)("Nouvelle substitution de variable")]))),_:1}),(0,s.bF)(b,null,{default:(0,s.k6)((()=>[(0,s.bF)(g,{ref:"form",onSubmit:(0,a.D$)(o.handleSave,["prevent"])},{default:(0,s.k6)((()=>[(0,s.bF)(u,{modelValue:o.localForm.regex,"onUpdate:modelValue":t[0]||(t[0]=e=>o.localForm.regex=e),label:"Expression régulière à remplacer",rules:[e=>!!e||"L'expression est requise"],required:""},null,8,["modelValue","rules"]),(0,s.bF)(d,{modelValue:o.localForm.mode,"onUpdate:modelValue":t[1]||(t[1]=e=>o.localForm.mode=e),class:"mt-3"},{default:(0,s.k6)((()=>[(0,s.bF)(c,{value:"variable",label:"Utiliser une variable capturée"}),(0,s.bF)(c,{value:"fixed",label:"Utiliser une valeur fixe"})])),_:1},8,["modelValue"]),"variable"===o.localForm.mode?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.bF)(p,{modelValue:o.localForm.sourceStep,"onUpdate:modelValue":t[2]||(t[2]=e=>o.localForm.sourceStep=e),items:r.availableSteps,label:"Étape source","item-title":"label","item-value":"value",rules:[e=>null!==e||"L'étape source est requise"],required:""},null,8,["modelValue","items","rules"]),null!==o.localForm.sourceStep?((0,s.uX)(),(0,s.Wv)(p,{key:0,modelValue:o.localForm.targetVariable,"onUpdate:modelValue":t[3]||(t[3]=e=>o.localForm.targetVariable=e),items:r.getAvailableVariables(o.localForm.sourceStep),label:"Variable à utiliser",rules:[e=>!!e||"La variable est requise"],required:""},null,8,["modelValue","items","rules"])):(0,s.Q3)("",!0)],64)):((0,s.uX)(),(0,s.Wv)(u,{key:1,modelValue:o.localForm.value,"onUpdate:modelValue":t[4]||(t[4]=e=>o.localForm.value=e),label:"Valeur fixe",rules:[e=>!!e||"La valeur est requise"],required:""},null,8,["modelValue","rules"]))])),_:1},8,["onSubmit"])])),_:1}),(0,s.bF)(h,null,{default:(0,s.k6)((()=>[(0,s.bF)(m),(0,s.bF)(v,{text:"",onClick:t[5]||(t[5]=t=>e.$emit("update:model-value",!1))},{default:(0,s.k6)((()=>t[8]||(t[8]=[(0,s.eW)("Annuler")]))),_:1}),(0,s.bF)(v,{color:"primary",onClick:o.handleSave},{default:(0,s.k6)((()=>t[9]||(t[9]=[(0,s.eW)("Enregistrer")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["model-value"])}var He={name:"SubstitutionDialog",props:{modelValue:{type:Boolean,required:!0},form:{type:Object,required:!0},availableSteps:{type:Array,required:!0},getAvailableVariables:{type:Function,required:!0}},emits:["update:model-value","save"],setup(e,{emit:t}){const r=(0,Ce.KR)(null),a=(0,Ce.KR)({...e.form});(0,s.wB)((()=>e.form),(e=>{a.value={...e}}),{deep:!0}),(0,s.wB)((()=>e.modelValue),(e=>{e&&console.log("SubstitutionDialog opened with form:",a.value)})),(0,s.sV)((()=>{console.log("SubstitutionDialog mounted with form:",e.form)}));const o=()=>{if(console.log("Save button clicked in SubstitutionDialog with form data:",a.value),!a.value.regex)return void console.error("Validation failed: regex is missing");if("variable"===a.value.mode){if(null===a.value.sourceStep||!a.value.targetVariable)return void console.error("Validation failed: sourceStep or targetVariable is missing")}else if(!a.value.value)return void console.error("Validation failed: fixed value is missing");const e={...a.value};console.log("Emitting save event with data:",e),t("save",e),t("update:model-value",!1)};return{form:r,localForm:a,handleSave:o}}};const Ke=(0,y.A)(He,[["render",Me]]);var Ye=Ke;function Ze(){const e=(0,Ce.KR)({}),t=t=>{console.log("Step progress event received:",t.detail);const{currentStepIndex:r,status:a}=t.detail;r>=0&&(e.value={...e.value,[r]:a}),"stopped"!==a&&"completed"!==a||(console.log("Clearing progress status - execution completed or stopped"),e.value={})};return{progressStatus:e,handleStepProgress:t}}function et(e,t){const r=[{title:"Corps de la réponse",value:"body"},{title:"En-têtes de la réponse",value:"headers"},{title:"URL de la réponse",value:"url"}],a=(0,Ce.KR)(!1),s=(0,Ce.KR)({name:"",regex:"",source:"body",required:!1}),o=(0,Ce.KR)(null),l=e=>{console.log("Opening capture dialog for step",e),s.value={name:"",regex:"",source:"body",required:!1},o.value=e,a.value=!0},i=r=>{if(console.log("saveCapture called with:",r),!r||!r.name||!r.regex)return void console.error("Invalid form data:",r);const s=o.value;if(null===s||void 0===s)return void console.error("No step index specified for capture, captureStepIndex is:",o.value);if(!e.steps||!e.steps[s])return void console.error(`Step at index ${s} not found. Steps:`,e.steps);const l=e.steps[s],i=Array.isArray(l.variableCaptures)?[...l.variableCaptures]:[],n={...r},u=[...i,n];console.log("Saving capture:",n,"for step",s),console.log("Current captures:",i),console.log("Updated captures will be:",u);const c={...l,variableCaptures:u};console.log("Emitting update-step with:",s,c),t("update-step",s,c),a.value=!1};return{captureSourceOptions:r,showCaptureDialog:a,captureForm:s,captureStepIndex:o,openCaptureDialog:l,saveCapture:i}}r(7642),r(8004),r(3853),r(5876),r(2475),r(5024),r(1698);function tt(e,t){const r=(0,Ce.KR)(!1),a=(0,Ce.KR)({regex:"",mode:"variable",sourceStep:null,targetVariable:"",value:""}),s=(0,Ce.KR)(null),o=e=>{console.log("Opening substitution dialog for step",e),a.value={regex:"",mode:"variable",sourceStep:null,targetVariable:"",value:""},s.value=e,r.value=!0},l=a=>{if(console.log("saveSubstitution called with:",a),!a||!a.regex)return void console.error("Invalid form data:",a);const o=s.value;if(null===o||void 0===o)return void console.error("No step index specified for substitution, substitutionStepIndex is:",s.value);if(!e.steps||!e.steps[o])return void console.error(`Step at index ${o} not found. Steps:`,e.steps);const l=e.steps[o],i=Array.isArray(l.variableSubstitutions)?[...l.variableSubstitutions]:[];let n={regex:a.regex};if("variable"===a.mode){if(null===a.sourceStep||!a.targetVariable)return void console.error("Missing sourceStep or targetVariable for variable substitution");n={...n,mode:"variable",targetVariable:a.targetVariable,sourceStep:a.sourceStep},console.log("[SUBSTITUTION] Adding variable substitution:",`regex=${n.regex}, targetVariable=${n.targetVariable}`)}else{if(!a.value)return void console.error("Missing fixed value for substitution");n={...n,mode:"fixed",value:a.value},console.log("[SUBSTITUTION] Adding fixed value substitution:",`regex=${n.regex}, value=${n.value}`)}const u=[...i,n];console.log("[SUBSTITUTION] Current substitutions:",i),console.log("[SUBSTITUTION] Substitutions state after adding:",u);const c={...l,variableSubstitutions:u};console.log("Emitting update-step with:",o,c),t("update-step",o,c),r.value=!1},i=t=>{if(null===t||void 0===t)return console.log("availableVariablesForStep called with null/undefined stepIndex"),["Sélectionnez d'abord une étape"];let r=[];if(e.steps&&Array.isArray(e.steps))for(let s=0;s<e.steps.length;s++)if(s!==t||0===t){const t=e.steps[s];if(t&&t.variableCaptures&&t.variableCaptures.length>0){const e=t.variableCaptures.map((e=>e.name));r=[...r,...e]}}if(e.results&&Array.isArray(e.results))for(let s=0;s<e.results.length;s++)if(e.results[s]&&e.results[s].capturedVariables){const t=Object.keys(e.results[s].capturedVariables);r=[...r,...t]}const a=[...new Set(r)];return 0===a.length?0===t?(console.log("Step 0: No variables available"),["Define variables in this step to use them here and in later steps"]):(console.log("No variables available for step",t),["Define variables in steps to use them here"]):(console.log("Variables available for step",t,":",a),a)};return{showSubstitutionDialog:r,substitutionForm:a,substitutionStepIndex:s,openSubstitutionDialog:o,saveSubstitution:l,availableVariablesForStep:i}}var rt={name:"StepsList",components:{ResultsSummary:Re,StepItem:Be,CaptureDialog:Je,SubstitutionDialog:Ye},props:{steps:{type:Array,required:!0},expandedStep:{type:Number,default:null},isReplaying:{type:Boolean,default:!1},results:{type:Array,default:()=>[]},currentStepIndex:{type:Number,default:-1},executionOptions:{type:Object,default:()=>({})}},emits:["toggle-step","update-step","toggle-all-steps","export-results","generate-pdf"],setup(e,{emit:t}){const{progressStatus:r,handleStepProgress:a}=Ze(),{captureSourceOptions:o,showCaptureDialog:l,captureForm:i,captureStepIndex:n,openCaptureDialog:u,saveCapture:c}=et(e,t),{showSubstitutionDialog:d,substitutionForm:p,substitutionStepIndex:g,openSubstitutionDialog:b,saveSubstitution:m,availableVariablesForStep:v}=tt(e,t),h=(0,s.EW)((()=>e.results&&e.results.length>0)),f=(0,s.EW)((()=>e.steps.map(((e,t)=>({label:`Étape ${t+1}: ${e.name||e.url}`,value:t})))));return(0,s.sV)((()=>{window.addEventListener("step-execution-progress",a),console.log("StepsList: Listening for step-execution-progress events")})),(0,s.xo)((()=>{window.removeEventListener("step-execution-progress",a)})),{hasResults:h,progressStatus:r,availableStepsForVariables:f,captureSourceOptions:o,showCaptureDialog:l,captureForm:i,captureStepIndex:n,openCaptureDialog:u,saveCapture:c,showSubstitutionDialog:d,substitutionForm:p,substitutionStepIndex:g,openSubstitutionDialog:b,saveSubstitution:m,availableVariablesForStep:v}}};const at=(0,y.A)(rt,[["render",me],["__scopeId","data-v-e9bee906"]]);var st=at;const ot={class:"variables-tab"},lt={class:"d-flex align-center"},it={key:0},nt={key:1,class:"text-grey"},ut={class:"d-flex align-center"},ct={key:2,class:"scrollable-section steps-variables-section"},dt={class:"d-flex align-center w-100"},pt={key:0},gt={key:1,class:"text-grey"};function bt(e,t,r,a,o,i){const n=(0,s.g2)("v-icon"),u=(0,s.g2)("v-chip"),c=(0,s.g2)("v-card-title"),d=(0,s.g2)("v-card-text"),p=(0,s.g2)("v-table"),g=(0,s.g2)("v-card"),b=(0,s.g2)("v-expansion-panel-title"),m=(0,s.g2)("v-expansion-panel-text"),v=(0,s.g2)("v-expansion-panel"),h=(0,s.g2)("v-expansion-panels");return(0,s.uX)(),(0,s.CE)("div",ot,[(0,s.bF)(g,{class:"mb-4 variables-card",variant:"outlined"},{default:(0,s.k6)((()=>[(0,s.bF)(c,{class:"d-flex justify-space-between align-center variables-header"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",lt,[(0,s.bF)(n,{icon:"mdi-earth-box",class:"mr-2"}),t[0]||(t[0]=(0,s.eW)(" Variables Globales "))]),r.globalVariables&&r.globalVariables.length>0?((0,s.uX)(),(0,s.Wv)(u,{key:0,color:"info",size:"small"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(r.globalVariables.length)+" variables globales ",1)])),_:1})):(0,s.Q3)("",!0)])),_:1}),r.globalVariables&&0!==r.globalVariables.length?((0,s.uX)(),(0,s.Wv)(d,{key:1,class:"scrollable-section"},{default:(0,s.k6)((()=>[(0,s.bF)(p,{density:"compact"},{default:(0,s.k6)((()=>[t[3]||(t[3]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Nom"),(0,s.Lk)("th",null,"Expression régulière"),(0,s.Lk)("th",null,"Source"),(0,s.Lk)("th",null,"Valeur capturée")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.globalVariables,((e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:t},[(0,s.Lk)("td",null,[(0,s.bF)(u,{color:"info",size:"small"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.name),1)])),_:2},1024)]),(0,s.Lk)("td",null,(0,l.v_)(e.regex),1),(0,s.Lk)("td",null,(0,l.v_)(i.getSourceLabel(e.source)),1),(0,s.Lk)("td",null,[i.getGlobalCapturedValue(e.name)?((0,s.uX)(),(0,s.CE)("span",it,(0,l.v_)(i.getGlobalCapturedValue(e.name)),1)):((0,s.uX)(),(0,s.CE)("span",nt,"Non capturée"))])])))),128))])])),_:1})])),_:1})):((0,s.uX)(),(0,s.Wv)(d,{key:0,class:"text-center pa-6"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{icon:"mdi-variable-box",size:"64",color:"grey-lighten-1",class:"mb-4"}),t[1]||(t[1]=(0,s.Lk)("div",{class:"text-h6 mb-2"},"Aucune variable globale définie",-1)),t[2]||(t[2]=(0,s.Lk)("div",{class:"text-body-2 text-grey mb-6"},' Ajoutez des variables globales à partir du bouton "Global Variables" dans les options d\'exécution. ',-1))])),_:1}))])),_:1}),(0,s.bF)(g,{class:"mb-4 variables-card"},{default:(0,s.k6)((()=>[(0,s.bF)(c,{class:"d-flex justify-space-between align-center variables-header"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",ut,[(0,s.bF)(n,{icon:"mdi-variable",class:"mr-2"}),t[4]||(t[4]=(0,s.eW)(" Variables capturées "))]),i.totalCapturedVariables>0?((0,s.uX)(),(0,s.Wv)(u,{key:0,color:"primary",size:"small"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(i.totalCapturedVariables)+" variables capturées ",1)])),_:1})):(0,s.Q3)("",!0)])),_:1}),0!==i.totalCapturedVariables||i.hasCapturingSteps?0===i.totalCapturedVariables&&i.hasCapturingSteps?((0,s.uX)(),(0,s.Wv)(d,{key:1,class:"text-center pa-6"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{icon:"mdi-database-minus",size:"64",color:"amber-darken-2",class:"mb-4"}),t[7]||(t[7]=(0,s.Lk)("div",{class:"text-h6 mb-2"},"Variables définies mais non capturées",-1)),t[8]||(t[8]=(0,s.Lk)("div",{class:"text-body-2 text-grey mb-6"}," Des captures de variables sont définies mais aucune n'a été trouvée dans les réponses. Lancez le replay pour capturer des variables. ",-1))])),_:1})):((0,s.uX)(),(0,s.CE)("div",ct,[(0,s.bF)(h,null,{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.stepsWithVariables,((e,r)=>((0,s.uX)(),(0,s.Wv)(v,{key:r},{default:(0,s.k6)((()=>[(0,s.bF)(b,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",dt,[(0,s.bF)(u,{size:"small",color:i.getMethodColor(e.method),class:"mr-2"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.method),1)])),_:2},1032,["color"]),(0,s.Lk)("span",null,(0,l.v_)(e.name||`Step ${e.index+1}`),1),(0,s.bF)(u,{size:"x-small",color:i.getCapturedVariablesCount(e)>0?"success":"warning",class:"ml-2"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(i.getCapturedVariablesCount(e))+" / "+(0,l.v_)(i.getDefinedVariablesCount(e)),1)])),_:2},1032,["color"])])])),_:2},1024),(0,s.bF)(m,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",null,[t[11]||(t[11]=(0,s.Lk)("div",{class:"subtitle-1 mb-3"},"Captures de variables",-1)),(0,s.bF)(p,{density:"compact"},{default:(0,s.k6)((()=>[t[10]||(t[10]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Nom"),(0,s.Lk)("th",null,"Expression"),(0,s.Lk)("th",null,"Source"),(0,s.Lk)("th",null,"Valeur"),(0,s.Lk)("th",null,"Statut")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.variableCaptures,((r,a)=>((0,s.uX)(),(0,s.CE)("tr",{key:a},[(0,s.Lk)("td",null,(0,l.v_)(r.name),1),(0,s.Lk)("td",null,(0,l.v_)(r.regex),1),(0,s.Lk)("td",null,(0,l.v_)(i.getSourceLabel(r.source)),1),(0,s.Lk)("td",null,[i.getCapturedValue(e,r.name)?((0,s.uX)(),(0,s.CE)("span",pt,(0,l.v_)(i.getCapturedValue(e,r.name)),1)):((0,s.uX)(),(0,s.CE)("span",gt,"Non capturée"))]),(0,s.Lk)("td",null,[(0,s.bF)(u,{size:"x-small",color:i.getCapturedValue(e,r.name)?"success":r.required?"error":"amber-darken-2"},{default:(0,s.k6)((()=>[i.getCapturedValue(e,r.name)?((0,s.uX)(),(0,s.Wv)(n,{key:0,start:"",size:"x-small"},{default:(0,s.k6)((()=>t[9]||(t[9]=[(0,s.eW)(" mdi-check ")]))),_:1})):((0,s.uX)(),(0,s.Wv)(n,{key:1,start:"",size:"x-small"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(r.required?"mdi-alert":"mdi-minus"),1)])),_:2},1024)),(0,s.eW)(" "+(0,l.v_)(i.getCapturedValue(e,r.name)?"Capturée":r.required?"Manquante (requise)":"Non trouvée"),1)])),_:2},1032,["color"])])])))),128))])])),_:2},1024)])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])):((0,s.uX)(),(0,s.Wv)(d,{key:0,class:"text-center pa-6"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{icon:"mdi-database-search",size:"64",color:"grey-lighten-1",class:"mb-4"}),t[5]||(t[5]=(0,s.Lk)("div",{class:"text-h6 mb-2"},"Aucune variable capturée",-1)),t[6]||(t[6]=(0,s.Lk)("div",{class:"text-body-2 text-grey mb-6"},"Aucune étape de ce scénario ne définit des captures de variables.",-1))])),_:1}))])),_:1})])}r(3579);var mt={name:"VariablesTab",props:{steps:{type:Array,required:!0},results:{type:Array,default:()=>[]},globalVariables:{type:Array,default:()=>[]}},computed:{stepsWithVariables(){return this.steps.map(((e,t)=>({...e,index:t,hasVariableCaptures:this.hasVariableCaptures(e),hasCapturedVariables:this.hasCapturedVariables(t)}))).filter((e=>e.hasVariableCaptures||e.hasCapturedVariables))},totalCapturedVariables(){let e=0;return this.steps.forEach(((t,r)=>{this.results&&this.results[r]&&this.results[r].capturedVariables&&(e+=Object.keys(this.results[r].capturedVariables).length)})),e},hasCapturingSteps(){return this.steps.some((e=>e.variableCaptures&&e.variableCaptures.length>0))}},methods:{hasVariableCaptures(e){return e.variableCaptures&&e.variableCaptures.length>0},hasCapturedVariables(e){return this.results&&this.results[e]&&this.results[e].capturedVariables&&Object.keys(this.results[e].capturedVariables).length>0},getCapturedVariablesCount(e){return this.results&&this.results[e.index]&&this.results[e.index].capturedVariables?Object.keys(this.results[e.index].capturedVariables).length:0},getDefinedVariablesCount(e){return(e.variableCaptures||[]).length},getCapturedValue(e,t){return this.results&&this.results[e.index]&&this.results[e.index].capturedVariables&&this.results[e.index].capturedVariables[t]||null},getMethodColor(e){const t={GET:"primary",POST:"success",PUT:"warning",DELETE:"error",PATCH:"info"};return t[e]||"grey"},getSourceLabel(e){const t={body:"Corps de la réponse",responseBody:"Corps de la réponse",headers:"En-têtes de la réponse",responseHeaders:"En-têtes de la réponse",url:"URL de la réponse"};return t[e]||e},getGlobalCapturedValue(e){return this.results&&this.results.globalVariables&&this.results.globalVariables[e]||null}}};const vt=(0,y.A)(mt,[["render",bt],["__scopeId","data-v-b21a4754"]]);var ht=vt,ft={name:"ReplayTab",components:{ReplayHeader:ee,ExecutionOptions:pe,StepsList:st,VariablesTab:ht},data(){return{scenario:null,scenarioSteps:[],expandedStep:null,expandedResult:null,isReplaying:!1,replayResults:[],executionOptions:{stopOnError:!0,stepInterval:1e3,showRuntimeProgress:!0,errorOnCapture:!1,baseUrl:"",globalVariables:[]},recordedRequestsData:null,autoLoadedData:!1,executionStatus:"Ready to start",currentStepIndex:-1,activeTab:"replay"}},computed:{executionStatusClass(){return this.executionStatus.includes("Error")||this.executionStatus.includes("Failed")?"error":this.executionStatus.includes("Complete")?"success":this.executionStatus.includes("Running")?"in-progress":""}},mounted(){console.log("ReplayTab mounted, checking for data..."),this.dumpStorageContents(),chrome.storage.local.get(["latestRecordedData","autoLoadLatestRecording","replayWindowData","replayWindowDataCount"],(e=>{console.log("Storage data check:",{autoLoad:e.autoLoadLatestRecording,latestRecordedCount:e.latestRecordedData?.length||0,replayWindowCount:e.replayWindowData?.length||0,countMetadata:e.replayWindowDataCount||0});const t=new URLSearchParams(window.location.search),r=t.get("state");if(r)try{const e=JSON.parse(decodeURIComponent(r));console.log("Found state param in URL:",e),e.directData&&console.log("URL indicates direct data transfer was attempted")}catch(a){console.error("Error parsing state param:",a)}if(e.replayWindowData&&e.replayWindowData.length>0)return console.log("Loading data from replayWindowData:",e.replayWindowData.length,"requests"),this.recordedRequestsData=e.replayWindowData,this.autoLoadedData=!0,this.convertRecordedDataToScenario(),void this.setCommonBaseUrl();e.latestRecordedData&&e.latestRecordedData.length>0?(console.log("Loading data from latestRecordedData:",e.latestRecordedData.length,"requests"),this.recordedRequestsData=e.latestRecordedData,this.autoLoadedData=!0,this.convertRecordedDataToScenario(),this.setCommonBaseUrl(),e.autoLoadLatestRecording&&chrome.storage.local.set({autoLoadLatestRecording:!1})):(console.log("No data to auto-load"),this.showNoDataMessage())}))},methods:{loadScenarioFile(e){let t;if(e instanceof File)t=e;else{if(!(e.target&&e.target.files&&e.target.files[0]))return console.error("Invalid file input:",e),void this.$root.$emit("show-snackbar",{text:"Invalid file input provided",color:"error"});t=e.target.files[0]}const r=new FileReader;r.onload=e=>{try{const t=JSON.parse(e.target.result);if(t.rawRequests&&Array.isArray(t.rawRequests))return console.log("Fichier exporté avec requêtes brutes détecté:",t.rawRequests.length),console.log("Structure d'une requête brute:",JSON.stringify(t.rawRequests[0],null,2)),this.recordedRequestsData=t.rawRequests.map((e=>({...e,body:e.body||e.requestBody}))),this.autoLoadedData=!0,this.convertRecordedDataToScenario(),this.$nextTick((()=>{this.setCommonBaseUrl()})),void this.$root.$emit("show-snackbar",{text:"Fichier exporté chargé avec succès - "+t.rawRequests.length+" requêtes",color:"success",timeout:3e3});this.processScenario(t)}catch(t){this.$root.$emit("show-snackbar",{text:"Error parsing file: "+t.message,color:"error"})}},r.readAsText(t)},processScenario(e){if(!e.openapi||!e.paths)return e.rawRequests&&Array.isArray(e.rawRequests)?(console.log("Fichier exporté avec format spécial RAW détecté:",e.rawRequests.length),this.recordedRequestsData=e.rawRequests,this.autoLoadedData=!0,this.convertRecordedDataToScenario(),void this.$root.$emit("show-snackbar",{text:"Fichier au format RAW chargé avec succès - "+e.rawRequests.length+" requêtes",color:"success",timeout:3e3})):void this.$root.$emit("show-snackbar",{text:"Format de fichier invalide. Veuillez charger un fichier OpenAPI 3.0 ou un export de Ark Replayr.",color:"error"});const t=e["x-ark-replayr"]&&"recording"===e["x-ark-replayr"].type;t?this.$root.$emit("show-snackbar",{text:"Fichier OpenAPI avec métadonnées complètes chargé",color:"success",timeout:3e3}):this.$root.$emit("show-snackbar",{text:"Fichier OpenAPI importé - certains détails peuvent être limités, préférez le format RAW pour les exportations",color:"info",timeout:5e3}),this.scenario=e,this.scenarioSteps=this.extractStepsFromOpenAPI(e),e["x-ark-replayr"]&&e["x-ark-replayr"].rawBodies&&(console.log("Extension x-ark-replayr avec corps bruts trouvée:",Object.keys(e["x-ark-replayr"].rawBodies).length),this.scenarioSteps.forEach(((t,r)=>{const a=t.originalOperationId||`op${r}`;e["x-ark-replayr"].rawBodies[a]&&(console.log(`Restauration du corps brut pour l'opération ${a}`),t.requestBody=e["x-ark-replayr"].rawBodies[a],t._originalRequestBody=e["x-ark-replayr"].rawBodies[a])}))),this.$nextTick((()=>{this.setCommonBaseUrl()}))},extractStepsFromOpenAPI(e){const t=[];for(const[r,a]of Object.entries(e.paths))for(const[e,s]of Object.entries(a)){if("parameters"===e||"summary"===e||"description"===e)continue;const a=s["x-original-url"]||"",o={name:s.summary||s.operationId,description:s.description,url:a,method:e.toUpperCase(),skip:!1,parameters:s.parameters,requestBody:s.requestBody,responses:s.responses,variableSubstitutions:[],variableCaptures:[],importedFromOpenAPI:!0,originalPath:r};s["x-variable-substitution"]&&(o.variableSubstitutions=s["x-variable-substitution"]),s["x-variable-capture"]&&(o.variableCaptures=s["x-variable-capture"]),t.push(o)}return this.$nextTick((()=>{this.$root.$emit("show-snackbar",{text:"Imported requests may have limited functionality due to browser security restrictions.",color:"warning",timeout:8e3})})),t},updateStep(e,t){e>=0&&e<this.scenarioSteps.length&&(this.scenarioSteps[e]={...this.scenarioSteps[e],...t},this.scenarioSteps=[...this.scenarioSteps])},toggleStepDetails(e){this.expandedStep=this.expandedStep===e?null:e},toggleResultDetails(e){this.expandedResult=this.expandedResult===e?null:e},convertRecordedDataToScenario(){this.recordedRequestsData&&this.recordedRequestsData.length?(console.log("Converting",this.recordedRequestsData.length,"recorded requests to scenario steps"),console.log("First request sample:",JSON.stringify(this.recordedRequestsData[0])),this.scenarioSteps=this.recordedRequestsData.map(((e,t)=>{let r="(unknown path)";try{const t=e.url||"";r=this.getPathFromUrl(t)}catch(s){console.warn("Error parsing URL:",s)}let a=e.requestBody||e.body;return console.log(`Request ${t+1} body:`,JSON.stringify(a,null,2)),{name:`Request ${t+1}: ${e.method||"GET"} ${r}`,url:e.url||"",method:e.method||"GET",enabled:!0,skip:!1,requestHeaders:e.requestHeaders||{},requestBody:a,responseHeaders:e.responseHeaders||{},variableSubstitutions:[],variableCaptures:e.variableCapture||[],_originalRequestBody:a,_imported:!0,_importMetadata:{timestamp:(new Date).toISOString(),originalFormat:typeof a,hasBeenTransformed:!1}}})),console.log("Converted to",this.scenarioSteps.length,"scenario steps"),console.log("Sample converted step:",JSON.stringify(this.scenarioSteps[0],null,2))):console.warn("No recorded data to convert to scenario")},getPathFromUrl(e){try{const t=new URL(e);return t.pathname}catch(t){return e}},toggleAllSteps(e){this.scenarioSteps.forEach((t=>{t.skip=!e,t.enabled=e}))},startReplay(){this.clearResults();const e=this.scenario&&(!this.scenario["x-ark-replayr"]||"recording"!==this.scenario["x-ark-replayr"].type);e&&this.$root.$emit("show-snackbar",{text:"Imported requests may have CORS limitations. For best results, record requests directly.",color:"warning",timeout:6e3}),this.isReplaying=!0,this.replayResults=[],this.executionStatus="Running replay...",this.currentStepIndex=-1,this.scenarioSteps.forEach((e=>{e.skip=!e.enabled})),r.e(578).then(r.bind(r,3197)).then((e=>{const t=e.default;window.addEventListener("step-execution-progress",this.handleStepProgress),t.startReplay(this.scenarioSteps,this.executionOptions).then((e=>{this.isReplaying=!1,this.replayResults=e,this.executionStatus="Execution Complete",this.currentStepIndex=-1,this.$root.$emit("show-snackbar",{text:`Replay completed: ${this.replayResults.filter((e=>"success"===e.status)).length} of ${this.replayResults.length} steps successful`,color:"success",timeout:4e3})})).catch((e=>{this.isReplaying=!1,this.executionStatus="Execution Failed",alert("Replay failed: "+e.message)})).finally((()=>{window.removeEventListener("step-execution-progress",this.handleStepProgress)}))})).catch((e=>{this.isReplaying=!1,this.executionStatus="Error loading replay service",console.error("Failed to load replayService:",e),alert("Error loading replay service: "+e.message)}))},handleStepProgress(e){const{currentStepIndex:t,results:r,status:a}=e.detail;console.log(`Step progress: step ${t+1}, status: ${a}`),this.currentStepIndex=t,r&&Array.isArray(r)&&(this.replayResults=r),"completed"===a?this.executionStatus="Execution Complete":"error"===a?this.executionStatus="Error in execution":"stopped"===a&&(this.executionStatus="Execution stopped due to error")},clearResults(){this.replayResults=[],chrome.storage.local.remove(["replayProgress","replayProgressTimestamp"],(()=>{console.log("Previous replay results cleared")}))},exportReplayResults(){const e=this.recordedRequestsData?JSON.parse(JSON.stringify(this.recordedRequestsData)):this.scenarioSteps.map((e=>{const t=e._originalRequestBody||e.requestBody;return console.log("Exporting original body structure:",JSON.stringify(t,null,2)),{url:e.url,method:e.method,requestHeaders:e.requestHeaders||{},requestBody:t,body:t,responseHeaders:e.responseHeaders||{},variableCapture:e.variableCaptures||[]}})),t={timestamp:(new Date).toISOString(),scenario:this.scenario?this.scenario.info?.title:"Recorded Requests Replay",description:this.scenario?this.scenario.info?.description:"Replay of recorded network requests",executionOptions:this.executionOptions,results:this.replayResults,rawRequests:e,exportFormat:{version:"2.2",preservesRawStructure:!0,date:(new Date).toISOString(),preservesOriginalBodyStructure:!0,isStandardOpenAPI:!1}},r=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),a=URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download=`raw-requests-${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.json`,s.onclick=()=>{setTimeout((()=>{URL.revokeObjectURL(a)}),150)},s.click(),this.$root.$emit("show-snackbar",{text:"Le fichier a été exporté avec succès au format RAW préservant la structure exacte de requêtes",color:"success",timeout:4e3})},generatePdfReport(){try{r.e(972).then(r.bind(r,2972)).then((({jsPDF:e})=>{Promise.all([r.e(972),r.e(343)]).then(r.t.bind(r,8343,23)).then((()=>{const t=new e;t.setFontSize(20),t.setTextColor(0,51,102),t.text("Network Request Replay Results",14,20),t.setFontSize(10),t.setTextColor(100,100,100),t.text(`Generated: ${(new Date).toLocaleString()}`,14,30),t.setFontSize(12),t.setTextColor(0,0,0),t.text(`Scenario: ${this.scenario?this.scenario.info.title:"Recorded Requests Replay"}`,14,40),this.scenario&&this.scenario.info.description&&(t.setFontSize(10),t.text(`Description: ${this.scenario.info.description}`,14,47)),t.setFontSize(14),t.setTextColor(0,51,102),t.text("Execution Summary",14,60);const r=this.replayResults.filter((e=>"success"===e.status)).length,a=this.replayResults.filter((e=>"error"===e.status)).length,s=this.replayResults.filter((e=>"skipped"===e.status)).length;t.autoTable({startY:65,head:[["Metric","Value"]],body:[["Total Steps",this.replayResults.length.toString()],["Successful",r.toString()],["Failed",a.toString()],["Skipped",s.toString()],["Success Rate",`${this.replayResults.length?Math.round(r/this.replayResults.length*100):0}%`]],theme:"grid",headStyles:{fillColor:[0,51,102],textColor:[255,255,255]},styles:{overflow:"linebreak"}});let o=t.autoTable.previous.finalY+15;t.setFontSize(14),t.setTextColor(0,51,102),t.text("Detailed Results",14,o);const l=this.replayResults.map(((e,t)=>[(t+1).toString(),e.step,e.status.toUpperCase(),"error"===e.status?e.error||"Error occurred":"OK"]));t.autoTable({startY:o+5,head:[["#","Step","Status","Details"]],body:l,theme:"grid",headStyles:{fillColor:[0,51,102],textColor:[255,255,255]},styles:{overflow:"linebreak"},columnStyles:{0:{cellWidth:10},2:{cellWidth:25}},didDrawCell:e=>{if(2===e.column.index&&"body"===e.section){const r=this.replayResults[e.row.index].status;"success"===r?(t.setFillColor(0,128,0,.1),t.rect(e.cell.x,e.cell.y,e.cell.width,e.cell.height,"F")):"error"===r?(t.setFillColor(255,0,0,.1),t.rect(e.cell.x,e.cell.y,e.cell.width,e.cell.height,"F")):"skipped"===r&&(t.setFillColor(255,165,0,.1),t.rect(e.cell.x,e.cell.y,e.cell.width,e.cell.height,"F"))}}});const i=t.internal.getNumberOfPages();for(let e=1;e<=i;e++)t.setPage(e),t.setFontSize(10),t.setTextColor(100,100,100),t.text(`Page ${e} of ${i}`,t.internal.pageSize.getWidth()/2,t.internal.pageSize.getHeight()-10,{align:"center"});t.save(`replay-report-${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.pdf`)}))})).catch((e=>{console.error("Error loading PDF libraries:",e),alert("Could not generate PDF. Please check console for errors.")}))}catch(e){console.error("Error generating PDF report:",e),alert("Error generating PDF report: "+e.message)}},clearAllReplayData(){confirm("Are you sure you want to clear all replay data? This action cannot be undone.")&&chrome.storage.local.remove(["latestRecordedData","replayWindowData","replayWindowDataCount","autoLoadLatestRecording","replayProgress","dataTimestamp"],(()=>{this.recordedRequestsData=null,this.scenario=null,this.scenarioSteps=[],this.replayResults=[],this.autoLoadedData=!1,this.$root.$emit("show-snackbar",{text:"All replay data has been cleared.",color:"success"})}))},dumpStorageContents(){chrome.storage.local.get(null,(e=>{console.log("All storage contents:",Object.keys(e)),e.latestRecordedData&&console.log("latestRecordedData info:",{count:e.latestRecordedData.length,firstItem:e.latestRecordedData[0]?{url:e.latestRecordedData[0].url,method:e.latestRecordedData[0].method}:null}),e.replayWindowData&&console.log("replayWindowData info:",{count:e.replayWindowData.length,firstItem:e.replayWindowData[0]?{url:e.replayWindowData[0].url,method:e.replayWindowData[0].method}:null})}))},showNoDataMessage(){this.executionStatus="No recorded data found to replay"},formatJson(e){if(!e)return"No data available";try{if("object"===typeof e)return JSON.stringify(e,null,2);if("string"===typeof e)try{const t=JSON.parse(e);return JSON.stringify(t,null,2)}catch{return e}return String(e)}catch(t){return console.error("Error formatting JSON:",t),String(e)}},async loadReplayFromFile(e){try{const t=e.target.files[0];if(!t)return void console.error("No file selected");const r=new FileReader;r.onload=async t=>{try{const r=t.target.result,a=JSON.parse(r);if(console.log("File content parsed as JSON:",a),a.rawRequests&&Array.isArray(a.rawRequests))console.log("Detected raw requests format with preserved structure:",a.rawRequests.length),this.recordedRequestsData=a.rawRequests,this.scenarioSteps=await this.replayService.convertRecordedDataToScenario(a.rawRequests);else if(a.results&&Array.isArray(a.results))this.recordedRequestsData=a.results.map((e=>e.request)),this.scenarioSteps=await this.replayService.convertRecordedDataToScenario(a.results.map((e=>e.request)));else if(a.openapi||a.swagger)this.scenarioSteps=this.replayService.extractStepsFromOpenAPI(a),console.log("Extracted steps from OpenAPI:",this.scenarioSteps.length);else if(a.log&&a.log.entries){const e=a.log.entries.map((e=>({url:e.request.url,method:e.request.method,requestHeaders:e.request.headers.reduce(((e,t)=>(e[t.name]=t.value,e)),{}),requestBody:this.extractBodyFromHAR(e.request),responseHeaders:e.response.headers.reduce(((e,t)=>(e[t.name]=t.value,e)),{})})));this.recordedRequestsData=e,this.scenarioSteps=await this.replayService.convertRecordedDataToScenario(e)}else{if(!Array.isArray(a))throw new Error("Format de fichier non reconnu");console.log("Processing array of requests:",a.length),this.recordedRequestsData=a,this.scenarioSteps=await this.replayService.convertRecordedDataToScenario(a)}this.setupScenario(),a.executionOptions&&(this.executionOptions=a.executionOptions),e.target.value="",console.log("Loaded steps:",this.scenarioSteps.length)}catch(r){console.error("Error processing file content:",r),this.showAlert("error",`Erreur lors de l'analyse du fichier: ${r.message}`)}},r.readAsText(t)}catch(t){console.error("Error loading file:",t),this.showAlert("error",`Erreur lors du chargement du fichier: ${t.message}`)}},extractBodyFromHAR(e){if(!e.postData)return null;if(e.postData.text)try{return e.postData.mimeType.includes("json")?JSON.parse(e.postData.text):e.postData.text}catch(t){return e.postData.text}return e.postData.params&&e.postData.params.length>0?e.postData.params.reduce(((e,t)=>(e[t.name]=t.value,e)),{}):null},exportToFile(){try{if(!this.recordedRequestsData||0===this.recordedRequestsData.length)return void this.showAlert("error","Aucune donnée à exporter");const e={timestamp:(new Date).toISOString(),rawRequests:this.recordedRequestsData,executionOptions:this.executionOptions||{}},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download=`network-recording-${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.json`,a.click(),setTimeout((()=>{URL.revokeObjectURL(r)}),150),this.showAlert("success","Export réussi!")}catch(e){console.error("Error exporting data:",e),this.showAlert("error",`Erreur lors de l'exportation: ${e.message}`)}},setCommonBaseUrl(){r.e(578).then(r.bind(r,3197)).then((e=>{const t=e.default,r=t.extractCommonBaseUrl(this.scenarioSteps);console.log("Base URL commune extraite:",r),r?(this.executionOptions.baseUrl=r,console.log("Base URL définie dans les options d'exécution:",this.executionOptions.baseUrl)):console.warn("Aucune base URL commune trouvée dans les étapes")})).catch((e=>{console.error("Erreur lors de l'extraction de la base URL commune:",e)}))},removeGlobalVariableFromSteps(e){console.log("Suppression de la variable globale de toutes les étapes:",e),e&&e.name?(this.scenarioSteps.forEach((t=>{t.variableCaptures&&t.variableCaptures.length>0&&(t.variableCaptures=t.variableCaptures.filter((t=>t.name!==e.name)))})),this.$root.$emit("show-snackbar",{text:`Variable globale "${e.name}" supprimée de toutes les étapes`,color:"success",timeout:3e3})):console.warn("Variable globale invalide à supprimer")}}};const yt=(0,y.A)(ft,[["render",H]]);var kt=yt,xt={name:"App",components:{RecordTab:z,ReplayTab:kt},data(){return{isReplayTab:!1}},mounted(){const e=new URLSearchParams(window.location.search);if("replay-window"===e.get("page"))return this.isReplayTab=!0,document.title="Network Request Replay",document.body.classList.add("full-window-mode"),document.documentElement.style.height="100%",document.documentElement.style.width="100%",document.documentElement.style.overflow="hidden",document.body.style.height="100%",document.body.style.width="100%",document.body.style.margin="0",document.body.style.padding="0",document.body.style.overflow="hidden",document.body.style.position="relative",void(document.getElementById("app").style.cssText+="width: 100vw !important; max-width: 100vw !important; margin: 0 !important; padding: 0 !important;");"replay"===e.get("tab")&&(this.isReplayTab=!0,document.body.classList.add("full-window-mode"),document.documentElement.style.height="100%",document.documentElement.style.overflow="hidden",document.body.style.height="100%",document.body.style.margin="0",document.body.style.padding="0",document.body.style.overflow="hidden")},methods:{openReplayTab(){chrome.runtime.sendMessage({action:"openAdvancedWindow",tab:"replay"},(e=>{e&&e.success?console.log("Replay tab opened with ID:",e.tabId):console.error("Failed to open replay tab")}))}}};const St=(0,y.A)(xt,[["render",o]]);var Rt=St,wt=r(9067),Ft=r(8493),Ct=r(4254),_t=(r(5211),(0,wt.$N)({components:Ft,directives:Ct,theme:{defaultTheme:"light",themes:{light:{colors:{primary:"#1976D2",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"}}}},icons:{defaultSet:"mdi"}}));const Vt=(0,a.Ef)(Rt);Vt.use(_t),Vt.mount("#app")},7126:function(e,t,r){r(4603),r(7566),r(8721)}},t={};function r(a){var s=t[a];if(void 0!==s)return s.exports;var o=t[a]={exports:{}};return e[a].call(o.exports,o,o.exports,r),o.exports}r.m=e,function(){var e=[];r.O=function(t,a,s,o){if(!a){var l=1/0;for(c=0;c<e.length;c++){a=e[c][0],s=e[c][1],o=e[c][2];for(var i=!0,n=0;n<a.length;n++)(!1&o||l>=o)&&Object.keys(r.O).every((function(e){return r.O[e](a[n])}))?a.splice(n--,1):(i=!1,o<l&&(l=o));if(i){e.splice(c--,1);var u=s();void 0!==u&&(t=u)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[a,s,o]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};r.t=function(a,s){if(1&s&&(a=this(a)),8&s)return a;if("object"===typeof a&&a){if(4&s&&a.__esModule)return a;if(16&s&&"function"===typeof a.then)return a}var o=Object.create(null);r.r(o);var l={};e=e||[null,t({}),t([]),t(t)];for(var i=2&s&&a;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((function(e){l[e]=function(){return a[e]}}));return l["default"]=function(){return a},r.d(o,l),o}}(),function(){r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(t,a){return r.f[a](e,t),t}),[]))}}(),function(){r.u=function(e){return"js/"+e+".js"}}(),function(){r.miniCssF=function(e){}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="extension_vue:";r.l=function(a,s,o,l){if(e[a])e[a].push(s);else{var i,n;if(void 0!==o)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+o){i=d;break}}i||(n=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,r.nc&&i.setAttribute("nonce",r.nc),i.setAttribute("data-webpack",t+o),i.src=a),e[a]=[s];var p=function(t,r){i.onerror=i.onload=null,clearTimeout(g);var s=e[a];if(delete e[a],i.parentNode&&i.parentNode.removeChild(i),s&&s.forEach((function(e){return e(r)})),t)return t(r)},g=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),n&&document.head.appendChild(i)}}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){r.p=""}(),function(){var e={57:0};r.f.j=function(t,a){var s=r.o(e,t)?e[t]:void 0;if(0!==s)if(s)a.push(s[2]);else{var o=new Promise((function(r,a){s=e[t]=[r,a]}));a.push(s[2]=o);var l=r.p+r.u(t),i=new Error,n=function(a){if(r.o(e,t)&&(s=e[t],0!==s&&(e[t]=void 0),s)){var o=a&&("load"===a.type?"missing":a.type),l=a&&a.target&&a.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+l+")",i.name="ChunkLoadError",i.type=o,i.request=l,s[1](i)}};r.l(l,n,"chunk-"+t,t)}},r.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,o,l=a[0],i=a[1],n=a[2],u=0;if(l.some((function(t){return 0!==e[t]}))){for(s in i)r.o(i,s)&&(r.m[s]=i[s]);if(n)var c=n(r)}for(t&&t(a);u<l.length;u++)o=l[u],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(c)},a=self["webpackChunkextension_vue"]=self["webpackChunkextension_vue"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=r.O(void 0,[504],(function(){return r(5123)}));a=r.O(a)})();